<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Post | Yusuf Talha ARABACI</title>
    <meta name="description" content="Cyber Security Blog by Yusuf Talha ARABACI">
    <meta name="author" content="Yusuf Talha ARABACI">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon.ico">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;700&display=swap"
        rel="stylesheet">

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- PrismJS for Syntax Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />

    <!-- Config -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        slate: {
                            850: '#151e2e',
                            900: '#0f172a',
                            950: '#020617',
                        },
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                            950: '#082f49',
                        },
                    },
                    typography: (theme) => ({
                        DEFAULT: {
                            css: {
                                color: theme('colors.slate.300'),
                                h1: { color: theme('colors.white') },
                                h2: { color: theme('colors.white') },
                                h3: { color: theme('colors.white') },
                                strong: { color: theme('colors.white') },
                                a: { color: theme('colors.brand.400') },
                                code: { color: theme('colors.brand.300') },
                            },
                        },
                    }),
                }
            }
        }
    </script>

    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #0f172a;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }

        .glass {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>

<body class="bg-slate-950 text-slate-300 font-sans antialiased selection:bg-brand-500 selection:text-white">

    <!-- Navbar -->
    <nav class="fixed w-full top-0 z-50 glass transition-all duration-300">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <a href="../index.html"
                    class="flex items-center gap-2 group text-slate-100 hover:text-brand-400 transition-colors">
                    <i class="fas fa-arrow-left"></i>
                    <span class="font-mono font-bold">Back to Home</span>
                </a>
            </div>
        </div>
    </nav>

    <main class="pt-32 pb-24 px-6">
        <article class="max-w-3xl mx-auto">
            <!-- Header -->
            <header class="mb-12 text-center">
                <div class="flex justify-center gap-2 mb-6">
                    <span
                        class="px-3 py-1 rounded-full bg-brand-500/10 text-brand-400 text-xs font-mono border border-brand-500/20">WRITEUP</span>
                </div>
                <h1 class="text-4xl md:text-5xl font-bold text-white mb-6 leading-tight">Threat Hunting with WAF Walkthrough — LetsDefend</h1>
                <div class="flex items-center justify-center gap-6 text-slate-400 text-sm font-mono">
                    <span><i class="far fa-calendar mr-2"></i> Oct 03, 2025</span>
                    <span><i class="far fa-clock mr-2"></i> 5 min read</span>
                </div>
            </header>

            <!-- Featured Image (Optional) -->
            <!-- <img src="..." class="w-full rounded-2xl mb-12 border border-slate-800" alt="Cover"> -->

            <!-- Content -->
            <div class="prose prose-invert prose-lg max-w-none hover:prose-a:text-brand-400">
<section class="section section--body section--first" name="3ec0"><div class="section-divider"><hr class="section-divider"/></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading graf--title" id="cb3d" name="cb3d">Threat Hunting with WAF Walkthrough — LetsDefend</h3><figure class="graf graf--figure graf-after--h3" id="b4d0" name="b4d0"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="366" data-image-id="0*aaFgUhGoEHzP09NU.png" data-is-featured="true" data-width="700" src="https://cdn-images-1.medium.com/max/800/0*aaFgUhGoEHzP09NU.png"/><figcaption class="imageCaption"><a class="markup--anchor markup--figure-anchor" data-href="https://letsdefend.io/" href="https://letsdefend.io/" rel="noopener ugc nofollow noopener noopener" target="_blank">LetsDefend — Blue Team Training Platform</a></figcaption></figure><h3 class="graf graf--h3 graf-after--figure" id="de9c" name="de9c">Introduction</h3><p class="graf graf--p graf-after--h3" id="ce7c" name="ce7c">A Web Application Firewall (WAF) is a security layer used to protect web applications. Unlike traditional firewalls, WAFs specifically target threats aimed at web applications. These threats include SQL injections, XSS (Cross-Site Scripting) attacks, file upload attacks, and other web-based threats.</p><p class="graf graf--p graf-after--p" id="f6fb" name="f6fb">WAF-based threat hunting is a proactive security approach aimed at protecting web applications. This process is carried out using logs, alerts, and analyses provided by WAFs. Threat hunters examine WAF data to identify potential threats, analyze the source of these threats, and develop strategies to prevent similar attacks in the future.</p><figure class="graf graf--figure graf-after--p" id="f4a2" name="f4a2"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="297" data-image-id="0*DvRCHqrdmU5Lv1or.png" data-width="790" src="https://cdn-images-1.medium.com/max/800/0*DvRCHqrdmU5Lv1or.png"/><figcaption class="imageCaption">( <strong class="markup--strong markup--figure-strong">Image Source</strong> : <a class="markup--anchor markup--figure-anchor" data-href="https://www.linkedin.com/pulse/what-waf-web-application-firewall-ronen-taieb/" href="https://www.linkedin.com/pulse/what-waf-web-application-firewall-ronen-taieb/" rel="noopener noreferrer noopener noopener" target="_blank">https://www.linkedin.com/pulse/what-waf-web-application-firewall-ronen-taieb/</a> )</figcaption></figure><p class="graf graf--p graf-after--figure" id="04df" name="04df">This lesson has provided an introduction to the topic. The next lesson will cover the “ <strong class="markup--strong markup--p-strong">Role of WAF in Threat Hunting</strong> “.</p><h3 class="graf graf--h3 graf-after--p" id="de59" name="de59">Questions</h3><p class="graf graf--p graf-after--h3 graf--trailing" id="2dcb" name="2dcb">No Anser Needed</p></div></div></section><section class="section section--body" name="c1e1"><div class="section-divider"><hr class="section-divider"/></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading" id="b9e0" name="b9e0">Role of WAF in Threat Hunting</h3><p class="graf graf--p graf-after--h3" id="7ebf" name="7ebf">WAF (Web Application Firewall) plays a critical role in the threat hunting process. The contributions provided by WAF are highly valuable for threat hunting. Below, the key contributions of WAF to threat hunting are summarized.</p><h3 class="graf graf--h3 graf-after--p" id="01ed" name="01ed">Real-Time Traffic Monitoring and Attack Detection</h3><p class="graf graf--p graf-after--h3" id="8514" name="8514">A Web Application Firewall (WAF) continuously monitors inbound and outbound traffic to web applications. WAFs can detect potential attacks in their early stages, which is critical for threat hunting.</p><ul class="postList"><li class="graf graf--li graf-after--p" id="ea3a" name="ea3a"><strong class="markup--strong markup--li-strong">Continuous Monitoring: </strong>The WAF monitors all requests to web applications and analyzes every incoming packet. It ensures that threats to the application are detected immediately. Traffic monitoring includes parameters such as IP addresses, protocols used, data volumes and request types.</li><li class="graf graf--li graf-after--li" id="5c3b" name="5c3b"><strong class="markup--strong markup--li-strong">Attack Detection: </strong>The WAF continuously scans traffic for specific attack patterns and signatures. For example, requests that contain common web attacks such as SQL injection or XSS (Cross-Site Scripting) are immediately detected and blocked by the WAF. This allows attackers to be stopped before they reach their target.</li><li class="graf graf--li graf-after--li" id="452e" name="452e"><strong class="markup--strong markup--li-strong">Real-time Intervention: </strong>The WAF’s instant monitoring capability allows for rapid response when an attack is detected. Threat hunters can then identify the source of the attack and take immediate security action.</li></ul><figure class="graf graf--figure graf-after--li" id="faa8" name="faa8"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="1042" data-image-id="0*cx66MkIkLNYO93wM.png" data-width="2000" src="https://cdn-images-1.medium.com/max/800/0*cx66MkIkLNYO93wM.png"/><figcaption class="imageCaption">( <strong class="markup--strong markup--figure-strong">Image Source</strong> : <a class="markup--anchor markup--figure-anchor" data-href="https://www.radware.com/cyberpedia/application-security/what-is-waf/" href="https://www.radware.com/cyberpedia/application-security/what-is-waf/" rel="noopener noreferrer noopener noopener" target="_blank">https://www.radware.com/cyberpedia/application-security/what-is-waf/</a> )</figcaption></figure><h3 class="graf graf--h3 graf-after--figure" id="315a" name="315a">Signature and Behavior-Based Detection</h3><p class="graf graf--p graf-after--h3" id="1c53" name="1c53">WAF uses two main methods to detect threats: signature-based detection and behavior-based detection. These methods provide comprehensive protection during the threat hunting process.</p><h3 class="graf graf--h3 graf-after--p" id="4dd8" name="4dd8">Signature-Based Detection</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="1566" name="1566"><strong class="markup--strong markup--li-strong">Protection Against Known Attacks: </strong>Signature-based detection is based on characteristic traces of known attack types. Using these signatures, WAF detects the traces that attacks leave in web traffic. For example, the WAF detects a known SQL injection attack pattern and blocks the attack.</li><li class="graf graf--li graf-after--li" id="20e3" name="20e3"><strong class="markup--strong markup--li-strong">Constant Updates: </strong>The signature databases of WAFs are constantly updated against cybersecurity threats. This enables rapid detection of newly discovered threats.</li></ul><h3 class="graf graf--h3 graf-after--li" id="ca56" name="ca56">Behavior-Based Detection</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="2104" name="2104"><strong class="markup--strong markup--li-strong">Anomaly Detection: </strong>Behavior-based detection monitors deviations from the normal operation of the system. For detecting previously unseen or unknown attacks, this method is very effective. For example, a user uploading or downloading large amounts of data at unusual times could be a sign of an attack.</li><li class="graf graf--li graf-after--li" id="96a3" name="96a3"><strong class="markup--strong markup--li-strong">Machine Learning Support: </strong>Behavior-based systems are often supported by machine learning algorithms. This allows the WAF to better differentiate between normal and anomalous behavior over time, and to more accurately detect attacks.</li></ul><figure class="graf graf--figure graf-after--li" id="f634" name="f634"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="968" data-image-id="0*gGxXzd_gWOk-1NXL.png" data-width="1830" src="https://cdn-images-1.medium.com/max/800/0*gGxXzd_gWOk-1NXL.png"/><figcaption class="imageCaption">( <strong class="markup--strong markup--figure-strong">Image Source</strong> : <a class="markup--anchor markup--figure-anchor" data-href="https://my.f5.com/manage/s/article/K28426659" href="https://my.f5.com/manage/s/article/K28426659" rel="noopener noreferrer noopener noopener" target="_blank">https://my.f5.com/manage/s/article/K28426659</a> )</figcaption></figure><h3 class="graf graf--h3 graf-after--figure" id="55b9" name="55b9">Detailed Logging and Reporting</h3><p class="graf graf--p graf-after--h3" id="6e18" name="6e18">One of the biggest advantages of WAF in the threat hunting process is its comprehensive logging and reporting capabilities. These features play a crucial role in monitoring and analyzing threats.</p><h3 class="graf graf--h3 graf-after--p" id="8f10" name="8f10">Comprehensive Logging</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="8540" name="8540"><strong class="markup--strong markup--li-strong">Data Monitoring: </strong>The WAF records every request made to web applications and the responses to those requests. This includes detailed information such as user activity, IP addresses, timestamps, and protocols used.</li><li class="graf graf--li graf-after--li" id="3e3b" name="3e3b"><strong class="markup--strong markup--li-strong">Record Suspicious Activity: </strong>The WAF logs all suspicious activity and blocked attacks it detects. These logs help threat hunters understand the source and nature of attacks.</li></ul><h3 class="graf graf--h3 graf-after--li" id="9c25" name="9c25">Reporting</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="8f0e" name="8f0e"><strong class="markup--strong markup--li-strong">Customized Reports: </strong>The WAF can generate detailed reports on attack activity over a specified time period. Attack types, frequency, and source are included in these reports.</li><li class="graf graf--li graf-after--li" id="a068" name="a068"><strong class="markup--strong markup--li-strong">Visualization and Analysis: </strong>WAF reports provide visualized data for threat hunters to better understand attacks. Graphs and tables show the distribution and impact of attacks over time.</li></ul><figure class="graf graf--figure graf-after--li" id="197d" name="197d"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="651" data-image-id="0*luGMiMpdx75uiwTa.png" data-width="1224" src="https://cdn-images-1.medium.com/max/800/0*luGMiMpdx75uiwTa.png"/><figcaption class="imageCaption">( <strong class="markup--strong markup--figure-strong">Image Source</strong> : <a class="markup--anchor markup--figure-anchor" data-href="https://splunkbase.splunk.com/app/2873" href="https://splunkbase.splunk.com/app/2873" rel="noopener noreferrer noopener noopener" target="_blank">https://splunkbase.splunk.com/app/2873</a> )</figcaption></figure><h3 class="graf graf--h3 graf-after--figure" id="41c1" name="41c1">Root Cause Analysis</h3><p class="graf graf--p graf-after--h3" id="77dc" name="77dc">In the threat hunting process, understanding the root cause of attacks is critical to preventing similar attacks in the future. For this type of analysis, the WAF is an essential tool.</p><h3 class="graf graf--h3 graf-after--p" id="32e2" name="32e2">Identification of the Root Cause</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="20ca" name="20ca"><strong class="markup--strong markup--li-strong">Source of the Attack: </strong>WAF logs show what IP addresses the attacks came from and what user-agents were used. This is the first step in identifying the source of the attack.</li><li class="graf graf--li graf-after--li" id="e5b1" name="e5b1"><strong class="markup--strong markup--li-strong">Method of Attack:</strong> WAF helps identify the techniques used by attackers and how these techniques work. For example, WAF logs can be used to understand how an SQL injection attack was executed and what commands were used.</li></ul><h3 class="graf graf--h3 graf-after--li" id="a3a4" name="a3a4">Attack Propagation Analysis</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="e9b7" name="e9b7"><strong class="markup--strong markup--li-strong">Timeline:</strong> A WAF can help identify when an attack started and how it progressed, as well as the steps taken by the attacker.</li><li class="graf graf--li graf-after--li" id="1dbd" name="1dbd"><strong class="markup--strong markup--li-strong">Affected Systems: </strong>WAF logs show which systems and applications were affected by the attack. This is important for stopping the spread of the attack and minimizing the damage.</li></ul><h3 class="graf graf--h3 graf-after--li" id="65e5" name="65e5">Real-time and Retrospective Analysis</h3><p class="graf graf--p graf-after--h3" id="0dec" name="0dec">WAF is used both to detect immediate threats and to analyze past attacks in the threat hunting process.</p><h3 class="graf graf--h3 graf-after--p" id="0d03" name="0d03">Real Time Analysis</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="df67" name="df67"><strong class="markup--strong markup--li-strong">Prompt Threat Detection: </strong>The WAF instantly monitors incoming traffic and responds immediately when it detects threats, ensuring attackers are quickly stopped.</li><li class="graf graf--li graf-after--li" id="3a49" name="3a49"><strong class="markup--strong markup--li-strong">Automatic Response: </strong>When a specific attack is detected, the WAF can automatically apply the specified rules, ensuring that attacks are contained before they spread.</li></ul><h3 class="graf graf--h3 graf-after--li" id="2572" name="2572">Retrospective Analysis</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="e24e" name="e24e"><strong class="markup--strong markup--li-strong">Analysis of the Archived Logs: </strong>The WAF archives logs to analyze attacks that have occurred in the past. This helps to understand how the attacks occurred and what methods were used.</li><li class="graf graf--li graf-after--li" id="2432" name="2432"><strong class="markup--strong markup--li-strong">Correlation Analysis: </strong>Old logs can be used to determine if attacks are related to each other. This helps to understand large and complex attacks.</li></ul><h3 class="graf graf--h3 graf-after--li" id="7b31" name="7b31">Post-Attack Remediation and Strategy Development</h3><p class="graf graf--p graf-after--h3" id="9402" name="9402">WAF-based threat hunting is not limited to detecting attacks; it also plays a critical role in improving post-attack processes and developing strategies against future threats.</p><h3 class="graf graf--h3 graf-after--p" id="1dc7" name="1dc7">Post-Attack Analysis</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="135b" name="135b"><strong class="markup--strong markup--li-strong">Incident Damage Evaluation: </strong>WAF helps identify affected systems and applications after an attack. This is used to understand what data has been compromised and what areas need remediation.</li><li class="graf graf--li graf-after--li" id="5bd8" name="5bd8"><strong class="markup--strong markup--li-strong">Vulnerability Identification: </strong>After the attack, WAF logs are analyzed to identify security vulnerabilities in the system. These vulnerabilities must be addressed to prevent similar attacks in the future.</li></ul><h3 class="graf graf--h3 graf-after--li" id="bfdc" name="bfdc">Strategy Development</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="96f6" name="96f6"><strong class="markup--strong markup--li-strong">Updating Security Policies: </strong>WAF-based analysis is used to evaluate the effectiveness of existing security policies and make necessary updates to build a stronger line of defense.</li><li class="graf graf--li graf-after--li" id="3b17" name="3b17"><strong class="markup--strong markup--li-strong">Training and Awareness: </strong>WAF insights can be used to train and raise awareness among security teams, enabling them to identify threats earlier and respond more effectively.</li></ul><h3 class="graf graf--h3 graf-after--li" id="194f" name="194f">Conclusion</h3><p class="graf graf--p graf-after--h3" id="36fe" name="36fe">WAF-based threat hunting provides a proactive defense mechanism against web application threats. Features such as instant traffic monitoring, signature- and behavior-based detection, detailed logging, and attack analysis enable threat hunters to identify attacks early and develop more effective security measures. This process is a critical tool not only for managing existing threats, but also for preventing potential future threats.</p><p class="graf graf--p graf-after--p" id="4b4b" name="4b4b">This lesson has discussed the importance of WAF in the threat hunting process. The next lesson will cover “ <strong class="markup--strong markup--p-strong">Using WAF in the Threat Hunting Process</strong> “.</p><h3 class="graf graf--h3 graf-after--p" id="929a" name="929a">Questions</h3><p class="graf graf--p graf-after--h3 graf--trailing" id="00e6" name="00e6">No Anser Needed</p></div></div></section><section class="section section--body" name="b2d6"><div class="section-divider"><hr class="section-divider"/></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading" id="371d" name="371d">Using WAF in the Threat Hunting Process</h3><p class="graf graf--p graf-after--h3" id="4645" name="4645">Web Application Firewall (WAF) plays a critical role in protecting web applications against various threats. Furthermore, during the threat hunting process, the data provided by WAF significantly supports the testing of hypotheses created by threat hunters. WAF helps threat hunters trace web-based attacks and understand the actions of attackers.</p><h3 class="graf graf--h3 graf-after--p" id="0ce6" name="0ce6">WAF and Threat Hunting</h3><p class="graf graf--p graf-after--h3" id="ca53" name="ca53">WAF assists threat hunters in detecting potential attacks targeting web applications. Threat hunters can identify the sources and targets of attacks through logs and alerts generated by WAF. For complex attacks targeting web applications, this process is critical.</p><h3 class="graf graf--h3 graf-after--p" id="dec6" name="dec6">Using WAF for Hypothesis Testing</h3><p class="graf graf--p graf-after--h3" id="ef26" name="ef26">During the threat hunting process, threat hunters create hypotheses to test specific attack vectors or the motives of attackers. WAF provides data that can be used to test these hypotheses. For example, repeated attack attempts from a specific IP address or unusual traffic spikes can help threat hunters validate their hypotheses.</p><h3 class="graf graf--h3 graf-after--p" id="4995" name="4995">Early Alerts and Detection of Anomalies</h3><p class="graf graf--p graf-after--h3" id="c1df" name="c1df">WAF enables threat hunters to detect web application attacks early, allowing them to analyze attacks from a broader perspective and assess the overall impact of the attack on the network.</p><h3 class="graf graf--h3 graf-after--p" id="0bcc" name="0bcc">Data Collection and Log Analysis</h3><p class="graf graf--p graf-after--h3" id="d431" name="d431">Collecting data and analyzing logs is one of the key functions of WAF in the threat hunting process. WAF monitors all traffic directed to web applications and generates logs for this traffic. These logs provide valuable information for threat hunters.</p><h3 class="graf graf--h3 graf-after--p" id="64c8" name="64c8">Collecting WAF Logs</h3><p class="graf graf--p graf-after--h3" id="6e1b" name="6e1b">WAF collects various types of data, such as HTTP/HTTPS requests, user agents, IP addresses, protocols used, and response codes. These logs serve as a starting point for threat hunters and are analyzed to trace potential threats.</p><h3 class="graf graf--h3 graf-after--p" id="19dd" name="19dd">Log Analysis</h3><p class="graf graf--p graf-after--h3" id="8564" name="8564">Analyzing WAF logs helps threat hunters understand the source, type, and scope of attacks. Logs can reveal how an attack was executed and the techniques used by the attacker. For example, repeated suspicious requests from a certain user agent can point to the presence of a bot or automated attack tool.</p><h3 class="graf graf--h3 graf-after--p" id="aa6d" name="aa6d">Correlation and Anomaly Detection</h3><p class="graf graf--p graf-after--h3" id="9334" name="9334">For more comprehensive analysis, WAF logs can be correlated with logs from other security systems. This can help threat hunters detect larger-scale attacks. In addition, log anomalies can help identify deviations from normal behavior and uncover unknown threats.</p><figure class="graf graf--figure graf-after--p" id="78a9" name="78a9"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="2143" data-image-id="0*jGSe2YBLcuWJfZtg.png" data-width="2000" src="https://cdn-images-1.medium.com/max/800/0*jGSe2YBLcuWJfZtg.png"/><figcaption class="imageCaption">( <strong class="markup--strong markup--figure-strong">Image Source</strong> : <a class="markup--anchor markup--figure-anchor" data-href="https://www.techmatrix.de/app-protect-dashboard/" href="https://www.techmatrix.de/app-protect-dashboard/" rel="noopener noreferrer noopener noopener" target="_blank">https://www.techmatrix.de/app-protect-dashboard/</a> )</figcaption></figure><h3 class="graf graf--h3 graf-after--figure" id="8031" name="8031">Detection and Analysis of Web Attacks</h3><p class="graf graf--p graf-after--h3" id="d31a" name="d31a">Attacks that target web applications are often detected by a WAF in the first stage of the attack. In order to identify different types of attacks and analyze their impact on web applications, WAF is an important tool.</p><h3 class="graf graf--h3 graf-after--p" id="189e" name="189e">Identifying Attack Types</h3><p class="graf graf--p graf-after--h3" id="8297" name="8297">WAF detects attack types such as SQL injection, XSS (Cross-Site Scripting), file inclusion, and other web-based attacks. WAF logs can reveal how these attacks were carried out and the methods used by attackers, allowing threat hunters to understand attack vectors and conduct broader analysis.</p><h3 class="graf graf--h3 graf-after--p" id="e3d0" name="e3d0">Analyzing Attacks</h3><p class="graf graf--p graf-after--h3" id="e1d4" name="e1d4">WAF logs detail detected attacks by providing information about the source, target, methods used, and results of the attack. Threat hunters can analyze this data to understand the impact of the attack and the motivations of the attacker. For example, repeated SQL injection attacks from a single IP address may indicate that the attacker is attempting to gain access to databases.</p><h3 class="graf graf--h3 graf-after--p" id="ff11" name="ff11">Evaluating the Impact of Attacks</h3><p class="graf graf--p graf-after--h3" id="6f26" name="6f26">WAF logs are also used to evaluate the impact of attacks on web applications. They are critical for determining whether the attack was successful, what data was accessed, and how the attack affected other components of the application.</p><h3 class="graf graf--h3 graf-after--p" id="7c3b" name="7c3b">Real-Time and Retrospective Web Traffic Analysis</h3><p class="graf graf--p graf-after--h3" id="898c" name="898c">WAF allows threat hunters to analyze web traffic both in real-time and retrospectively. These two methods provide different perspectives during the threat hunting process.</p><h3 class="graf graf--h3 graf-after--p" id="03fa" name="03fa">Real-Time Analysis</h3><p class="graf graf--p graf-after--h3" id="720a" name="720a">Real-time traffic monitoring allows WAF to instantly detect threats targeting web applications. Threat hunters can use this data to intervene immediately and prevent the attack from spreading. Threat hunting while attackers are still active is possible through real-time analysis.</p><h3 class="graf graf--h3 graf-after--p" id="6afb" name="6afb">Retrospective Analysis</h3><p class="graf graf--p graf-after--h3" id="6e29" name="6e29">The WAF archives logs to analyze historical web traffic. Retrospective analysis is used to track previous attacks, identify repeated attack attempts, and understand the evolution of attacks over time. It helps threat hunters understand attackers’ long-term strategies and predict future attacks.</p><h3 class="graf graf--h3 graf-after--p" id="bca4" name="bca4">Correlation and Trend Analysis</h3><p class="graf graf--p graf-after--h3" id="6cad" name="6cad">Logs can be used to identify trends related to web attacks. These trends can then be correlated with data from other security systems. As a result, large-scale and complex attacks can be understood, and future threats can be detected earlier.</p><h3 class="graf graf--h3 graf-after--p" id="017d" name="017d">Conclusion</h3><p class="graf graf--p graf-after--h3" id="1a40" name="1a40">In summary, WAF-based threat hunting plays a critical role in detecting and analyzing threats that target web applications. WAF provides threat hunters with valuable insights into monitoring web traffic, detecting attacks, and understanding their impact. Threat hunters can test their hypotheses and identify the source of threats through data collection, log analysis, in-depth investigation of web attacks, and both real-time and retrospective traffic analysis. This process is an essential approach to improving the security of web applications. It also makes web applications more resilient to future threats.</p><p class="graf graf--p graf-after--p" id="df44" name="df44">This lesson has discussed the use of WAF in the threat hunting process. In the next lesson, “ <strong class="markup--strong markup--p-strong">Web-based Brute Force Attack Hypothesis</strong> “ will be covered.</p><h3 class="graf graf--h3 graf-after--p" id="49cb" name="49cb">Questions</h3><p class="graf graf--p graf-after--h3 graf--trailing" id="4d52" name="4d52">No Anser Needed</p></div></div></section><section class="section section--body" name="cc30"><div class="section-divider"><hr class="section-divider"/></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading" id="0f7c" name="0f7c">Web-based Brute Force Attack Hypothesis</h3><h3 class="graf graf--h3 graf-after--h3" id="543e" name="543e">Hypothesis</h3><p class="graf graf--p graf-after--h3" id="3a09" name="3a09">A threat actor may be targeting login forms on a web application using brute force methods to gain unauthorized access and steal credentials.</p><figure class="graf graf--figure graf-after--p" id="8b6b" name="8b6b"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="357" data-image-id="0*gqvC9lf2TrPcrMoB.png" data-width="742" src="https://cdn-images-1.medium.com/max/800/0*gqvC9lf2TrPcrMoB.png"/><figcaption class="imageCaption">( <strong class="markup--strong markup--figure-strong">Image Source</strong> : <a class="markup--anchor markup--figure-anchor" data-href="https://www.thesslstore.com/blog/brute-force-attack-definition-how-brute-force-works/" href="https://www.thesslstore.com/blog/brute-force-attack-definition-how-brute-force-works/" rel="noopener noreferrer noopener noopener" target="_blank">https://www.thesslstore.com/blog/brute-force-attack-definition-how-brute-force-works/</a> )</figcaption></figure><h3 class="graf graf--h3 graf-after--figure" id="f966" name="f966">Data Sources</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="acf9" name="acf9"><strong class="markup--strong markup--li-strong">WAF Logs:</strong> Repeated login attempts and failed authentication requests targeting login forms.</li><li class="graf graf--li graf-after--li" id="d220" name="d220"><strong class="markup--strong markup--li-strong">Web Server Logs:</strong> Suspicious IP addresses making repeated requests and unusual data uploads/downloads.</li><li class="graf graf--li graf-after--li" id="cf4b" name="cf4b"><strong class="markup--strong markup--li-strong">IPS/IDS Logs:</strong> Abnormal traffic spikes and attack activities targeting the web application.</li></ul><h3 class="graf graf--h3 graf-after--li" id="de43" name="de43">Analysis Steps</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="4425" name="4425"><strong class="markup--strong markup--li-strong">Login Attempts:</strong> Monitor WAF logs for multiple failed login attempts originating from specific IP addresses. These attempts may involve repeated tries using the same username.</li><li class="graf graf--li graf-after--li" id="b8ab" name="b8ab"><strong class="markup--strong markup--li-strong">IP Address Analysis:</strong> Use web server logs to identify IP addresses involved in repeated login attempts and investigate other activities associated with these addresses.</li><li class="graf graf--li graf-after--li" id="bd85" name="bd85"><strong class="markup--strong markup--li-strong">Login Timestamps:</strong> Analyze the timeframes during which login attempts are concentrated. Unusual login attempts during off-hours may indicate a brute force attack.</li><li class="graf graf--li graf-after--li" id="2ef1" name="2ef1"><strong class="markup--strong markup--li-strong">WAF and IPS/IDS Alerts:</strong> Correlate brute force attack alerts triggered by WAF with IPS/IDS logs to identify the attacker’s activities across other network components.</li><li class="graf graf--li graf-after--li" id="9270" name="9270"><strong class="markup--strong markup--li-strong">User-Agents:</strong> Examine user-agents used during suspicious login attempts. Repeated login attempts with the same user-agent but different usernames may indicate the use of automated tools.</li><li class="graf graf--li graf-after--li" id="e7ef" name="e7ef"><strong class="markup--strong markup--li-strong">Credential Theft:</strong> After successful login attempts, check for suspicious activities in user accounts. Pay attention to unexpected data access or attempts to exfiltrate data.</li></ul><h3 class="graf graf--h3 graf-after--li" id="9c01" name="9c01">Expected Outcomes</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="22b0" name="22b0">Intense brute force attempts from specific IP addresses in WAF logs.</li><li class="graf graf--li graf-after--li" id="defe" name="defe">Failed login attempts followed by a successful login from the same IP address.</li><li class="graf graf--li graf-after--li" id="d7c5" name="d7c5">Abnormal traffic spikes and attack activities targeting the web application in IPS/IDS logs.</li></ul><h3 class="graf graf--h3 graf-after--li" id="8c58" name="8c58">Summary</h3><p class="graf graf--p graf-after--h3" id="2d77" name="2d77">WAF plays a critical role in detecting brute force attacks and protecting against them. Threat hunters can analyze WAF and IPS/IDS logs to determine the source, target, and techniques used by attackers. Analysis with WAF is vital for preventing serious security breaches, such as credential theft, and enhancing the security of web applications.</p><h3 class="graf graf--h3 graf-after--p" id="9001" name="9001">Questions</h3><p class="graf graf--p graf-after--h3 graf--trailing" id="ac9c" name="ac9c">No Anser Needed</p></div></div></section><section class="section section--body section--last" name="7731"><div class="section-divider"><hr class="section-divider"/></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading" id="dad8" name="dad8">Practical Lab</h3><h3 class="graf graf--h3 graf-after--h3" id="f345" name="f345">Hypothesis</h3><p class="graf graf--p graf-after--h3" id="0ad1" name="0ad1"><strong class="markup--strong markup--p-strong">Note</strong>: The questions in this section are prepared for Threat Hunting based on the following hypothesis.</p><p class="graf graf--p graf-after--p" id="a9d8" name="a9d8"><strong class="markup--strong markup--p-strong">Hypothesis</strong>: Attackers might be trying to exploit the Directory Traversal vulnerability in the organization’s web applications to gain unauthorized access to sensitive files and configuration information on the server.</p><h3 class="graf graf--h3 graf-after--p" id="c469" name="c469">Threat Hunting Lab Environment</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="63a2" name="63a2">WAF Events (FortiWeb)</li><li class="graf graf--li graf-after--li" id="470e" name="470e">SIEM (Wazuh)</li><li class="graf graf--li graf-after--li" id="97bf" name="97bf">Firewall Traffic Events</li><li class="graf graf--li graf-after--li" id="9e5a" name="9e5a">CTI Events (<a class="markup--anchor markup--li-anchor" data-href="https://app.letsdefend.io/threat-intelligence-feed" href="https://app.letsdefend.io/threat-intelligence-feed" rel="noopener noreferrer noopener" target="_blank">Threat Intel LetsDefend Platform</a>)</li></ul><h3 class="graf graf--h3 graf-after--li" id="cb79" name="cb79">Lab Notes</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="05a2" name="05a2">Analyze the logs between “Aug 8, 2024 00:00 — Aug 13, 2024 00:00” to answer the questions below.</li><li class="graf graf--li graf-after--li" id="b09e" name="b09e">Subsequent questions require correct answers from previous ones. Answer all questions strictly in the order they appear.</li></ul><h3 class="graf graf--h3 graf-after--li" id="e2f9" name="e2f9">Questions</h3><p class="graf graf--p graf-after--h3" id="088e" name="088e"><strong class="markup--strong markup--p-strong">Note:</strong> Analyze the logs between “Aug 8, 2024 00:00 — Aug 13, 2024 00:00” to answer the questions below.</p><p class="graf graf--p graf-after--p" id="c07f" name="c07f"><strong class="markup--strong markup--p-strong">Note</strong>: Subsequent questions require correct answers from previous ones. Answer all questions strictly in the order they appear.</p><blockquote class="graf graf--blockquote graf-after--p" id="2d84" name="2d84"><strong class="markup--strong markup--blockquote-strong">According to WAF logs, what is the URL where the Directory Traversal attack occurred most frequently?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="a2cc" name="a2cc">Use the filter “data.subtype: waf” in SIEM. Check the values in the “data.url” field.</p><figure class="graf graf--figure graf-after--p" id="b2ca" name="b2ca"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="924" data-image-id="1*woEGDa62G34NK56BDMyZuA.png" data-width="1893" src="https://cdn-images-1.medium.com/max/800/1*woEGDa62G34NK56BDMyZuA.png"/></figure><p class="graf graf--p graf-after--figure" id="9c4e" name="9c4e"><strong class="markup--strong markup--p-strong">Answer: </strong>/page.php?file=../../../../etc/shadow</p><blockquote class="graf graf--blockquote graf-after--p" id="34e2" name="34e2"><strong class="markup--strong markup--blockquote-strong">What is the URL of the Directory Traversal attack that was allowed by the WAF?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="4e49" name="4e49">Use the filters “data.subtype: waf” and “data.action: Alert” in SIEM.</p><figure class="graf graf--figure graf-after--p" id="ff8c" name="ff8c"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="849" data-image-id="1*Lws_8FcuGAzvt12KfDiTag.png" data-width="1880" src="https://cdn-images-1.medium.com/max/800/1*Lws_8FcuGAzvt12KfDiTag.png"/></figure><p class="graf graf--p graf-after--figure" id="cc8e" name="cc8e"><strong class="markup--strong markup--p-strong">Answer:</strong>/page.php?file=../../../../home/user/.ssh/id_rsa</p><blockquote class="graf graf--blockquote graf-after--p" id="4610" name="4610"><strong class="markup--strong markup--blockquote-strong">What is the HTTP status code of the Directory Traversal attack that was allowed by the WAF?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="7a27" name="7a27">Apply the filters “data.subtype: waf” and “data.action: Alert” in SIEM. Locate the “return_code” value within the “full_log”.</p><figure class="graf graf--figure graf-after--p" id="dc69" name="dc69"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="245" data-image-id="1*d9VtggWq0LsNsz_UQPHo3w.png" data-width="1338" src="https://cdn-images-1.medium.com/max/800/1*d9VtggWq0LsNsz_UQPHo3w.png"/></figure><p class="graf graf--p graf-after--figure" id="681a" name="681a"><strong class="markup--strong markup--p-strong">Answer: </strong>200</p><blockquote class="graf graf--blockquote graf-after--p" id="042c" name="042c"><strong class="markup--strong markup--blockquote-strong">During previous stages of the threat hunting process, an IP address was detected performing a directory traversal attack that was allowed by the WAF. This same IP address has also launched a different type of web attack. What type of web attack is it?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="bd6c" name="bd6c">Identify the IP address from the output generated by applying ‘data.subtype: waf’ and ‘data.action: Alert’ filters in SIEM. Then review WAF logs to examine different attack types originating from this IP address.</p><p class="graf graf--p graf-after--p" id="c866" name="c866">We see the source address '16.61.7.181' in the previous stage.</p><figure class="graf graf--figure graf-after--p" id="5500" name="5500"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="926" data-image-id="1*q81fiePDc9xz_VZuuVNpJg.png" data-width="1911" src="https://cdn-images-1.medium.com/max/800/1*q81fiePDc9xz_VZuuVNpJg.png"/></figure><p class="graf graf--p graf-after--figure" id="22f5" name="22f5"><strong class="markup--strong markup--p-strong">Answer: </strong>OS Command Injection</p><blockquote class="graf graf--blockquote graf-after--p" id="b3a1" name="b3a1"><strong class="markup--strong markup--blockquote-strong">During previous stages of the threat hunting process, an IP address was detected performing a directory traversal attack that was allowed by the WAF. This same IP address has also launched a different type of web attack. What WAF action was taken against this web attack?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="29c9" name="29c9">Apply the filter “data.subtype: waf” in SIEM. Check the “data.action” field in the log entry related to the web attack.</p><figure class="graf graf--figure graf-after--p" id="31e7" name="31e7"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="823" data-image-id="1*GjvzG4LqTBHV78pIMF11wA.png" data-width="1863" src="https://cdn-images-1.medium.com/max/800/1*GjvzG4LqTBHV78pIMF11wA.png"/></figure><p class="graf graf--p graf-after--figure" id="0632" name="0632"><strong class="markup--strong markup--p-strong">Answer: </strong>Block</p><blockquote class="graf graf--blockquote graf-after--p" id="e7b3" name="e7b3"><strong class="markup--strong markup--blockquote-strong">What is the target server IP address of the Directory Traversal attack allowed by the WAF?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="90b8" name="90b8">Apply the filters “data.subtype: waf” and “data.action: Alert” in SIEM. Check the “data.dstip” field.</p><figure class="graf graf--figure graf-after--p" id="f72f" name="f72f"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="278" data-image-id="1*-YsBUNDR59qsWgUmlG9NfA.png" data-width="1410" src="https://cdn-images-1.medium.com/max/800/1*-YsBUNDR59qsWgUmlG9NfA.png"/></figure><p class="graf graf--p graf-after--figure" id="9239" name="9239"><strong class="markup--strong markup--p-strong">Answer: </strong>10.10.10.88</p><blockquote class="graf graf--blockquote graf-after--p" id="798b" name="798b"><strong class="markup--strong markup--blockquote-strong">Which APT group does the IP address that carried out the directory traversal attack allowed by the WAF belong to?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="07d4" name="07d4">Search for the IP address in the Threat Intel LetsDefend Platform.</p><figure class="graf graf--figure graf-after--p" id="7338" name="7338"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="535" data-image-id="1*xjtLg78ErcNdoPiGEDSOmQ.png" data-width="1743" src="https://cdn-images-1.medium.com/max/800/1*xjtLg78ErcNdoPiGEDSOmQ.png"/></figure><p class="graf graf--p graf-after--figure" id="7963" name="7963"><strong class="markup--strong markup--p-strong">Answer: </strong>APT-LL-23</p><blockquote class="graf graf--blockquote graf-after--p" id="dfe1" name="dfe1"><strong class="markup--strong markup--blockquote-strong">What is another reported IP address belonging to the same APT group that carried out the directory traversal attack allowed by the WAF?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="39f7" name="39f7">Search for the APT group’s name in the Threat Intel LetsDefend Platform.</p><figure class="graf graf--figure graf-after--p" id="4bcf" name="4bcf"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="612" data-image-id="1*s9Yy-aJyyWn5SLvFbUsNNA.png" data-width="1727" src="https://cdn-images-1.medium.com/max/800/1*s9Yy-aJyyWn5SLvFbUsNNA.png"/></figure><p class="graf graf--p graf-after--figure" id="210a" name="210a"><strong class="markup--strong markup--p-strong">Answer: </strong>101.203.172.3</p><blockquote class="graf graf--blockquote graf-after--p" id="12d1" name="12d1"><strong class="markup--strong markup--blockquote-strong">During earlier stages of Threat Hunting, an IP address was identified executing Directory Traversal attacks. Subsequently, another IP address belonging to the same threat group was discovered. What is the source IP address that accessed this related external IP address in a ‘local → WAN’ pattern?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="d78f" name="d78f">Locate the IP address of APT Group that was identified in the Threat Intel platform. Apply the filters “rule.groups: firewall” and “data.dstip: “ in SIEM.</p><figure class="graf graf--figure graf-after--p" id="a7d2" name="a7d2"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="229" data-image-id="1*ZG3TWF9ZjxKMBzOivVWl4Q.png" data-width="1535" src="https://cdn-images-1.medium.com/max/800/1*ZG3TWF9ZjxKMBzOivVWl4Q.png"/></figure><p class="graf graf--p graf-after--figure" id="5efa" name="5efa"><strong class="markup--strong markup--p-strong">Answer: </strong>10.10.10.88</p><blockquote class="graf graf--blockquote graf-after--p" id="1401" name="1401"><strong class="markup--strong markup--blockquote-strong">Earlier in the Threat Hunting process, an IP address performing Directory Traversal attacks was identified. Another IP address from the same threat group was later found. What was the firewall action on the endpoint’s access request to this external IP address?”</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="602e" name="602e">Locate the IP address of APT Group that was identified in the Threat Intel platform. Apply the filters “rule.groups: firewall” and “data.dstip: [IP_Address]”. Then check the “data.action” field.</p><p class="graf graf--p graf-after--p graf--trailing" id="9188" name="9188"><strong class="markup--strong markup--p-strong">Answer: </strong>block</p></div></div></section>
</div>
        </article>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 pt-16 pb-8 border-t border-slate-800">
        <div class="max-w-4xl mx-auto px-6 text-center">
            <div class="flex justify-center gap-8 mb-8">
                <a href="https://github.com/yusufarbc" target="_blank"
                    class="text-slate-400 hover:text-white transition-colors text-2xl"><i class="fab fa-github"></i></a>
                <a href="https://linkedin.com/in/yusufarbc" target="_blank"
                    class="text-slate-400 hover:text-[#0077b5] transition-colors text-2xl"><i
                        class="fab fa-linkedin"></i></a>
                <a href="https://x.com/yusufarbc" target="_blank"
                    class="text-slate-400 hover:text-white transition-colors text-2xl"><i
                        class="fab fa-x-twitter"></i></a>
            </div>
            <p class="text-slate-600 text-sm font-mono">© 2025 Yusuf Talha ARABACI</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

</body>

</html>
