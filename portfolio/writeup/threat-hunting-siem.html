<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Post | Yusuf Talha ARABACI</title>
    <meta name="description" content="Cyber Security Blog by Yusuf Talha ARABACI">
    <meta name="author" content="Yusuf Talha ARABACI">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon.ico">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;700&display=swap"
        rel="stylesheet">

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- PrismJS for Syntax Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />

    <!-- Config -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        slate: {
                            850: '#151e2e',
                            900: '#0f172a',
                            950: '#020617',
                        },
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                            950: '#082f49',
                        },
                    },
                    typography: (theme) => ({
                        DEFAULT: {
                            css: {
                                color: theme('colors.slate.300'),
                                h1: { color: theme('colors.white') },
                                h2: { color: theme('colors.white') },
                                h3: { color: theme('colors.white') },
                                strong: { color: theme('colors.white') },
                                a: { color: theme('colors.brand.400') },
                                code: { color: theme('colors.brand.300') },
                            },
                        },
                    }),
                }
            }
        }
    </script>

    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #0f172a;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }

        .glass {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Enhanced Content Styling - Stronger Rules */
        .prose h3,
        .prose .graf--h3,
        h3.graf--h3 {
            color: #f1f5f9 !important;
            font-size: 1.75rem !important;
            font-weight: 700 !important;
            margin-top: 2.5rem !important;
            margin-bottom: 1.25rem !important;
            line-height: 1.3 !important;
            display: block !important;
            font-family: 'Inter', sans-serif !important;
        }

        .prose h2,
        .prose .graf--h2,
        h2.graf--h2 {
            color: #f1f5f9 !important;
            font-size: 2rem !important;
            font-weight: 800 !important;
            margin-top: 3rem !important;
            margin-bottom: 1.5rem !important;
            line-height: 1.2 !important;
            display: block !important;
            font-family: 'Inter', sans-serif !important;
        }

        .prose h4,
        .prose .graf--h4,
        h4.graf--h4 {
            color: #e2e8f0 !important;
            font-size: 1.25rem !important;
            font-weight: 600 !important;
            margin-top: 1.5rem !important;
            margin-bottom: 0.75rem !important;
            line-height: 1.4 !important;
            display: block !important;
        }

        .prose p,
        .prose .graf--p,
        p.graf--p {
            margin-bottom: 1.25rem !important;
            line-height: 1.75 !important;
            color: #cbd5e1 !important;
            font-size: 1.05rem !important;
        }

        .prose ul,
        .prose .postList,
        ul.postList {
            margin-top: 1rem !important;
            margin-bottom: 1.5rem !important;
            padding-left: 1.75rem !important;
            list-style-type: disc !important;
        }

        .prose li,
        .prose .graf--li,
        li.graf--li {
            margin-bottom: 0.75rem !important;
            line-height: 1.7 !important;
            color: #cbd5e1 !important;
        }

        .prose blockquote,
        .prose .graf--blockquote,
        blockquote.graf--blockquote {
            border-left: 4px solid #38bdf8 !important;
            padding-left: 1.25rem !important;
            margin: 1.75rem 0 !important;
            font-style: italic !important;
            color: #cbd5e1 !important;
            background: rgba(56, 189, 248, 0.08) !important;
            padding: 1.25rem !important;
            border-radius: 0.5rem !important;
        }

        .prose strong,
        .markup--strong {
            color: #f8fafc !important;
            font-weight: 600 !important;
        }

        .prose figure,
        .prose .graf--figure,
        figure.graf--figure {
            margin: 2.5rem 0 !important;
        }

        .prose img,
        .prose .graf-image,
        img.graf-image {
            border-radius: 0.75rem !important;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4) !important;
            max-width: 100% !important;
            height: auto !important;
        }

        .imageCaption,
        figcaption.imageCaption {
            text-align: center !important;
            font-size: 0.875rem !important;
            color: #94a3b8 !important;
            margin-top: 0.75rem !important;
            font-style: italic !important;
        }

        /* Section spacing */
        .section,
        section.section {
            margin-bottom: 2.5rem !important;
        }

        /* Code blocks */
        .prose code,
        .prose pre {
            background: rgba(30, 41, 59, 0.6) !important;
            border-radius: 0.375rem !important;
            padding: 0.25rem 0.5rem !important;
            font-family: 'JetBrains Mono', monospace !important;
            font-size: 0.9rem !important;
        }

        .prose pre code {
            padding: 0 !important;
        }
    </style>
</head>

<body class="bg-slate-950 text-slate-300 font-sans antialiased selection:bg-brand-500 selection:text-white">

    <!-- Navbar -->
    <nav class="fixed w-full top-0 z-50 glass transition-all duration-300">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <a href="../index.html"
                    class="flex items-center gap-2 group text-slate-100 hover:text-brand-400 transition-colors">
                    <i class="fas fa-arrow-left"></i>
                    <span class="font-mono font-bold">Back to Home</span>
                </a>
            </div>
        </div>
    </nav>

    <main class="pt-32 pb-24 px-6">
        <article class="max-w-3xl mx-auto">
            <!-- Header -->
            <header class="mb-12 text-center">
                <div class="flex justify-center gap-2 mb-6">
                    <span
                        class="px-3 py-1 rounded-full bg-brand-500/10 text-brand-400 text-xs font-mono border border-brand-500/20">WRITEUP</span>
                </div>
                <h1 class="text-4xl md:text-5xl font-bold text-white mb-6 leading-tight">Threat Hunting with SIEM Walkthrough — LetsDefend</h1>
                <div class="flex items-center justify-center gap-6 text-slate-400 text-sm font-mono">
                    <span><i class="far fa-calendar mr-2"></i> Sep 21, 2025</span>
                    <span><i class="far fa-clock mr-2"></i> 5 min read</span>
                </div>
            </header>

            <!-- Featured Image (Optional) -->
            <!-- <img src="..." class="w-full rounded-2xl mb-12 border border-slate-800" alt="Cover"> -->

            <!-- Content -->
            <div class="prose prose-invert prose-lg max-w-none hover:prose-a:text-brand-400">
<section class="section section--body section--first" name="content"><figure class="graf graf--figure graf-after--h3" id="1779" name="1779"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="399" data-image-id="0*MV50j2d8HexWcGdC.png" data-is-featured="true" data-width="764" src="https://cdn-images-1.medium.com/max/800/0*MV50j2d8HexWcGdC.png"/><figcaption class="imageCaption"><a class="markup--anchor markup--figure-anchor" data-href="https://letsdefend.io/" href="https://letsdefend.io/" rel="noopener ugc nofollow noopener noopener" target="_blank">LetsDefend — Blue Team Training Platform</a></figcaption></figure><h3 class="graf graf--h3 graf-after--figure" id="09df" name="09df">Introduction</h3><p class="graf graf--p graf-after--h3" id="a5fc" name="a5fc">In today’s digital world, the number and complexity of cyber threats are increasing rapidly. Developing an effective defense strategy against these threats is becoming more challenging every day. In this context, SIEM Systems and Threat Hunting activities play a critical role in enhancing an organization’s cybersecurity maturity.</p><p class="graf graf--p graf-after--p" id="010a" name="010a">SIEM (Security Information and Event Management) systems are security technologies that collect log data from various sources, analyze this data, and generate meaningful insights using correlation rules. SIEM systems are equipped with capabilities such as real-time monitoring, event detection, alerting, and reporting. These features enable security teams to detect anomalies and suspicious activities occurring within the network.</p><p class="graf graf--p graf-after--p" id="4ab8" name="4ab8">On the other hand, Threat Hunting is a proactive research process aimed at detecting and eliminating cyber threats. Threat Hunting goes beyond simply responding to alerts generated by SIEM; it also aims to uncover unknown or hidden threats. This process involves security analysts developing specific hypotheses and searching for potential threats within the network.</p><p class="graf graf--p graf-after--p" id="69b0" name="69b0">The relationship between SIEM and Threat Hunting stems from the complementary nature of these two approaches. SIEM provides a broad spectrum of data, offering critical information that threat hunters need. Threat hunters, in turn, perform in-depth analyses on the data provided by SIEM to identify and validate potential threats. This synergy strengthens an organization’s security posture, making it better prepared against cyberattacks.</p><p class="graf graf--p graf-after--p" id="60ce" name="60ce">This lesson has introduced the course content. The next lesson will cover the “<strong class="markup--strong markup--p-strong">Role of SIEM in Threat Hunting</strong>” will be discussed.</p><h3 class="graf graf--h3 graf-after--p" id="7bfc" name="7bfc">Questions</h3><p class="graf graf--p graf-after--h3 graf--trailing" id="d517" name="d517">No Anser Needed</p></div></div></section><section class="section section--body" name="598d"><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading" id="b763" name="b763">Role of SIEM in Threat Hunting</h3><p class="graf graf--p graf-after--h3" id="468f" name="468f">SIEM (Security Information and Event Management) systems play a critical role in detecting and preventing cybersecurity threats. In threat hunting processes, SIEM’s comprehensive data collection, analysis, and correlation capabilities enable the rapid and effective detection of potential threats.</p><h3 class="graf graf--h3 graf-after--p" id="e8bc" name="e8bc">Data Collection and Aggregation</h3><p class="graf graf--p graf-after--h3" id="e731" name="e731">SIEM systems collect, aggregate, and store data from multiple sources, including network devices, servers, applications, endpoints, and security devices. By analyzing this data, SIEM helps identify anomalies and potential threats.</p><ul class="postList"><li class="graf graf--li graf-after--p" id="e45d" name="e45d"><strong class="markup--strong markup--li-strong">Log Collection from Various Sources:</strong> Logs are collected from firewalls, IDS/IPS, antivirus systems, DLP (Data Loss Prevention) tools, and other security devices.</li><li class="graf graf--li graf-after--li" id="1e8d" name="1e8d"><strong class="markup--strong markup--li-strong">Data Enrichment:</strong> Collected data is enriched with contextual information, such as IP address geolocation and threat intelligence.</li><li class="graf graf--li graf-after--li" id="c3af" name="c3af"><strong class="markup--strong markup--li-strong">Centralized Storage:</strong> All logs are stored in a centralized location, enabling quick access when needed.</li></ul><figure class="graf graf--figure graf-after--li" id="145e" name="145e"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="421" data-image-id="0*Mu7xAmpFVC6THHcG.png" data-width="721" src="https://cdn-images-1.medium.com/max/800/0*Mu7xAmpFVC6THHcG.png"/><figcaption class="imageCaption">( <strong class="markup--strong markup--figure-strong">Image Source</strong> : <a class="markup--anchor markup--figure-anchor" data-href="https://www.elastic.co/campaigns/elastic-guide-to-threat-hunting" href="https://www.elastic.co/campaigns/elastic-guide-to-threat-hunting" rel="noopener noreferrer noopener noopener" target="_blank">https://www.elastic.co/campaigns/elastic-guide-to-threat-hunting</a> )</figcaption></figure><h3 class="graf graf--h3 graf-after--figure" id="ad1c" name="ad1c">Real-Time Analysis and Correlation</h3><p class="graf graf--p graf-after--h3" id="1a30" name="1a30">SIEM analyzes collected data in real time and generates meaningful insights using correlation rules. Thus it allows for the establishment of relationships between data from different sources, enabling faster detection of potential threats.</p><ul class="postList"><li class="graf graf--li graf-after--p" id="8024" name="8024"><strong class="markup--strong markup--li-strong">Anomaly Detection:</strong> It identifies abnormal behavior in user and system activities.</li><li class="graf graf--li graf-after--li" id="8be6" name="8be6"><strong class="markup--strong markup--li-strong">Correlation Rules:</strong> It establishes relationships between different logs to create meaningful events.</li><li class="graf graf--li graf-after--li" id="7763" name="7763"><strong class="markup--strong markup--li-strong">Instant Alerts:</strong> It generates immediate alerts and notifications for detected anomalies.</li></ul><h3 class="graf graf--h3 graf-after--li" id="ec24" name="ec24">Incident Detection and Response</h3><p class="graf graf--p graf-after--h3" id="ea2f" name="ea2f">SIEM notifies the security team of detected incidents and provides the necessary information for rapid response. This ensures that threats are quickly contained, minimizing damage.</p><ul class="postList"><li class="graf graf--li graf-after--p" id="f371" name="f371"><strong class="markup--strong markup--li-strong">Incident Management:</strong> It enables quick and effective management of detected incidents.</li><li class="graf graf--li graf-after--li" id="0180" name="0180"><strong class="markup--strong markup--li-strong">Alert Prioritization:</strong> It prioritizes incoming alerts based on their severity.</li><li class="graf graf--li graf-after--li" id="d197" name="d197"><strong class="markup--strong markup--li-strong">Response and Remediation:</strong> It facilitates rapid response and corrective actions against detected threats.</li></ul><h3 class="graf graf--h3 graf-after--li" id="f99f" name="f99f">Reporting and Visualization</h3><p class="graf graf--p graf-after--h3" id="a2f1" name="a2f1">SIEM systems present the data and findings from threat hunting processes in the form of meaningful reports and visualizations, helping security teams and management better understand the threat landscape.</p><ul class="postList"><li class="graf graf--li graf-after--p" id="c5b2" name="c5b2"><strong class="markup--strong markup--li-strong">Detailed Reporting:</strong> It provides detailed reports of threat hunting findings, facilitating information sharing with upper management and stakeholders.</li><li class="graf graf--li graf-after--li" id="e881" name="e881"><strong class="markup--strong markup--li-strong">Dynamic Dashboards:</strong> It offers live and interactive dashboards for real-time threat visualization and improved monitoring processes.</li><li class="graf graf--li graf-after--li" id="513b" name="513b"><strong class="markup--strong markup--li-strong">Compliance Reports:</strong> It generates regulatory compliance reports to ensure organizations meet legal requirements.</li></ul><h3 class="graf graf--h3 graf-after--li" id="d97f" name="d97f">Automation and Orchestration</h3><p class="graf graf--p graf-after--h3" id="4d28" name="4d28">SIEM systems improve security operations by automating threat hunting processes and integrating with other security tools, reducing the need for manual intervention and enabling faster responses to threats.</p><ul class="postList"><li class="graf graf--li graf-after--p" id="20f6" name="20f6"><strong class="markup--strong markup--li-strong">Automated Threat Detection: </strong>It automates repetitive tasks and threat detection processes.</li><li class="graf graf--li graf-after--li" id="1256" name="1256"><strong class="markup--strong markup--li-strong">SOAR Integration:</strong> SIEM integrates with SOAR (Security Orchestration, Automation, and Response) tools to accelerate incident response processes.</li><li class="graf graf--li graf-after--li" id="7409" name="7409"><strong class="markup--strong markup--li-strong">Increased Efficiency:</strong> Automation and orchestration enhance the efficiency of security teams, enabling more effective defense against threats.</li></ul><h3 class="graf graf--h3 graf-after--li" id="5222" name="5222">Summary</h3><p class="graf graf--p graf-after--h3" id="d1e5" name="d1e5">SIEM systems are essential for detecting and preventing cybersecurity threats. They excel in threat hunting by collecting, analyzing, and correlating data from multiple sources, enabling rapid identification of anomalies and potential threats. Key features include real-time analysis, incident prioritization, and automated responses, which enhance security team efficiency. SIEM also provides detailed reporting and dynamic dashboards for better threat visualization and compliance. By automating processes and integrating with tools like SOAR, SIEM reduces manual effort and accelerates threat response, making organizations more resilient against cyber threats.</p><p class="graf graf--p graf-after--p" id="9206" name="9206">This lesson has explained the importance of SIEM in threat hunting processes. The next lesson will focus on <strong class="markup--strong markup--p-strong">“Creating and Testing Hypotheses”</strong> .</p><h3 class="graf graf--h3 graf-after--p" id="b668" name="b668">Questions</h3><p class="graf graf--p graf-after--h3 graf--trailing" id="18c4" name="18c4">No Anser Needed</p></div></div></section><section class="section section--body" name="30e4"><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading" id="4414" name="4414">Creating and Testing Hypotheses</h3><p class="graf graf--p graf-after--h3" id="cca8" name="cca8">Creating hypotheses is a critical step in the threat hunting process. Cybersecurity analysts determine how potential threats might emerge based on existing data and threat intelligence, and they develop hypotheses accordingly. These hypotheses guide the detection of specific attacker behaviors or abnormal activities.</p><figure class="graf graf--figure graf-after--p" id="6d66" name="6d66"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="676" data-image-id="0*id6b7Z8ltJlqKSlt.png" data-width="945" src="https://cdn-images-1.medium.com/max/800/0*id6b7Z8ltJlqKSlt.png"/></figure><h3 class="graf graf--h3 graf-after--figure" id="b7c4" name="b7c4">Creating Hypotheses</h3><h4 class="graf graf--h4 graf-after--h3" id="59a4" name="59a4">Data Analysis and Preliminary Review</h4><p class="graf graf--p graf-after--h4" id="3f45" name="3f45">The first step in the threat hunting process is the rapid and effective examination of collected data. During this phase, logs collected by the SIEM system, network traffic, and endpoint data must be reviewed. This initial review is the cornerstone for identifying potential threats and anomalies.</p><p class="graf graf--p graf-after--p" id="bc9c" name="bc9c">During the data review, you need to look for the following abnormal behaviors and unusual activities:</p><ul class="postList"><li class="graf graf--li graf-after--p" id="4903" name="4903"><strong class="markup--strong markup--li-strong">Unusual Access Attempts: </strong>Attempts by users to access systems or data they do not normally access.</li><li class="graf graf--li graf-after--li" id="57d2" name="57d2"><strong class="markup--strong markup--li-strong">Suspicious Login Attempts:</strong> Multiple failed login attempts by a user or logins at unusual times.</li><li class="graf graf--li graf-after--li" id="ba15" name="ba15"><strong class="markup--strong markup--li-strong">Unexpected Data Transfers:</strong> Unusual data flows on the network, especially large file transfers or high bandwidth usage.</li><li class="graf graf--li graf-after--li" id="16cc" name="16cc"><strong class="markup--strong markup--li-strong">Unusual System Resource Usage: </strong>Sudden and unexpected spikes in resource usage, such as CPU, memory, or disk usage.</li></ul><p class="graf graf--p graf-after--li" id="08b0" name="08b0">Historical event records and threat intelligence data provide important clues for detecting new threats. Security analysts review past security incidents to assess the likelihood of similar threats reoccurring. Additionally, current threat intelligence sources (e.g., ISACs, commercial threat feeds) can be utilized to gain insight into the current threat landscape.</p><h4 class="graf graf--h4 graf-after--p" id="f404" name="f404">Threat Models and TTPs</h4><p class="graf graf--p graf-after--h4" id="8d09" name="8d09">In the threat hunting process, understanding the techniques and methods commonly used by attackers is critical as it helps security analysts detect potential threats more effectively. Common techniques include phishing, malware distribution, brute force attacks, and data exfiltration.</p><p class="graf graf--p graf-after--p" id="929e" name="929e">The MITRE ATT&amp;CK Framework systematically classifies the techniques and procedures used by attackers, guiding security analysts in the following areas:</p><ul class="postList"><li class="graf graf--li graf-after--p" id="961f" name="961f"><strong class="markup--strong markup--li-strong">Tactics:</strong> Basically what attackers are trying to achieve (e.g., gaining initial access, privilege escalation).</li><li class="graf graf--li graf-after--li" id="6450" name="6450"><strong class="markup--strong markup--li-strong">Techniques:</strong> The methods attackers use to achieve the tactics (e.g., phishing, PowerShell usage).</li><li class="graf graf--li graf-after--li" id="d093" name="d093"><strong class="markup--strong markup--li-strong">Procedures:</strong> Details on how specific attacker groups implement the techniques.</li></ul><p class="graf graf--p graf-after--li" id="e975" name="e975">By using this framework, analysts identify potential attack vectors and make the threat hunting process more effective.</p><h4 class="graf graf--h4 graf-after--p" id="65e0" name="65e0">Defining Hypotheses</h4><p class="graf graf--p graf-after--h4" id="6a24" name="6a24">During the hypothesis creation process, security analysts define specific threat scenarios and attack vectors. These scenarios help understand the potential threats an organization faces. Such as:</p><ul class="postList"><li class="graf graf--li graf-after--p" id="5cf9" name="5cf9"><strong class="markup--strong markup--li-strong">Insider Threats:</strong> For example, an employee attempting to steal sensitive data.</li><li class="graf graf--li graf-after--li" id="376a" name="376a"><strong class="markup--strong markup--li-strong">APT (Advanced Persistent Threats):</strong> Long-term, targeted attacks aimed at a specific organization.</li><li class="graf graf--li graf-after--li" id="b476" name="b476"><strong class="markup--strong markup--li-strong">Data Exfiltration:</strong> The leakage of critical data.</li></ul><p class="graf graf--p graf-after--li" id="eace" name="eace">Hypotheses should explain how a specific event or behavior can be detected. Well-defined hypotheses include the following components:</p><ul class="postList"><li class="graf graf--li graf-after--p" id="d385" name="d385"><strong class="markup--strong markup--li-strong">Definition:</strong> Clearly states what the hypothesis aims to detect and the type of threat it addresses.</li><li class="graf graf--li graf-after--li" id="331d" name="331d"><strong class="markup--strong markup--li-strong">Expected Indicators:</strong> Specific indicators to look for to test the hypothesis (e.g., frequent copying of a specific file type, abnormal data flows at certain times).</li><li class="graf graf--li graf-after--li" id="6a58" name="6a58"><strong class="markup--strong markup--li-strong">Testing Methods:</strong> These describe how the hypothesis will be tested and which data sources will be used.</li><li class="graf graf--li graf-after--li" id="1302" name="1302"><strong class="markup--strong markup--li-strong">Expected Outcomes:</strong> The results expected if the hypothesis is confirmed or disproven.</li></ul><h3 class="graf graf--h3 graf-after--li" id="6fb5" name="6fb5">Testing Hypotheses</h3><h4 class="graf graf--h4 graf-after--h3" id="10d0" name="10d0">Data Collection</h4><p class="graf graf--p graf-after--h4" id="a9ad" name="a9ad">The first step in hypothesis testing is gathering the necessary data to evaluate the hypothesis. During this process, various data sources are utilized:</p><ul class="postList"><li class="graf graf--li graf-after--p" id="e28e" name="e28e"><strong class="markup--strong markup--li-strong">Identifying Sources:</strong> Identify all data sources relevant to the hypothesis.</li><li class="graf graf--li graf-after--li" id="9424" name="9424"><strong class="markup--strong markup--li-strong">Collection Methods:</strong> Decide on data collection methods (e.g., syslog, agent-based collection, API integrations) and implement them accordingly.</li><li class="graf graf--li graf-after--li" id="20d9" name="20d9"><strong class="markup--strong markup--li-strong">Data Storage:</strong> Store the collected data in a data pool for analysis.</li></ul><h4 class="graf graf--h4 graf-after--li" id="332d" name="332d">Data Analysis</h4><p class="graf graf--p graf-after--h4" id="c874" name="c874">After data collection, the collected data is analyzed in detail. During this phase, the abnormal behaviors and activities specified in the hypothesis should be examined.</p><ul class="postList"><li class="graf graf--li graf-after--p" id="8f37" name="8f37"><strong class="markup--strong markup--li-strong">Preprocessing:</strong> The collected data is preprocessed to remove unnecessary information and prepare it for analysis.</li><li class="graf graf--li graf-after--li" id="3164" name="3164"><strong class="markup--strong markup--li-strong">Data Visualization:</strong> Visualizing data through graphs and tables makes it easier to identify anomalies and patterns.</li><li class="graf graf--li graf-after--li" id="ea05" name="ea05"><strong class="markup--strong markup--li-strong">Data Filtering: </strong>Filtering for specific data types and events relevant to the hypothesis.</li></ul><h4 class="graf graf--h4 graf-after--li" id="e321" name="e321">Analysis Process</h4><ul class="postList"><li class="graf graf--li graf-after--h4" id="9c5e" name="9c5e"><strong class="markup--strong markup--li-strong">Anomaly Detection:</strong> Identifying anomalies in user and system behavior.</li><li class="graf graf--li graf-after--li" id="071a" name="071a"><strong class="markup--strong markup--li-strong">Trend Analysis:</strong> Examining data patterns and trends to detect unusual activities.</li><li class="graf graf--li graf-after--li" id="3de1" name="3de1"><strong class="markup--strong markup--li-strong">Behavioral Analysis:</strong> Investigating deviations from normal user activities to identify abnormal behavior.</li></ul><h4 class="graf graf--h4 graf-after--li" id="5347" name="5347">Correlation and Anomaly Detection</h4><p class="graf graf--p graf-after--h4" id="1b26" name="1b26">During the data analysis process, correlating different data sources yields more meaningful and comprehensive results.</p><ul class="postList"><li class="graf graf--li graf-after--p" id="b78d" name="b78d"><strong class="markup--strong markup--li-strong">Correlation Rules:</strong> These are rules created to establish relationships between different logs and data sources. For example, a user downloading a large amount of data during a specific time frame and then accessing sensitive data during the same period.</li><li class="graf graf--li graf-after--li" id="fcd7" name="fcd7"><strong class="markup--strong markup--li-strong">Event Correlation: </strong>It is basically associating similar events and activities to see the bigger picture.</li></ul><h4 class="graf graf--h4 graf-after--li" id="4018" name="4018">Anomaly and Suspicious Activity Detection</h4><ul class="postList"><li class="graf graf--li graf-after--h4" id="c028" name="c028"><strong class="markup--strong markup--li-strong">Anomaly Detection Methods: </strong>You can utilize machine learning algorithms, statistical analysis, and rule-based approaches to detect anomalies.</li><li class="graf graf--li graf-after--li" id="62fa" name="62fa"><strong class="markup--strong markup--li-strong">Identifying Suspicious Activities: </strong>Evaluate whether abnormal behaviors and activities are suspicious.</li></ul><h4 class="graf graf--h4 graf-after--li" id="a76e" name="a76e">Validation and Conclusion</h4><p class="graf graf--p graf-after--h4" id="4374" name="4374">If this hypothesis is confirmed, it means that a potential threat has been identified. Necessary actions should then be taken. If the hypothesis is not confirmed, the process must be repeated and new hypotheses formulated.</p><ul class="postList"><li class="graf graf--li graf-after--p" id="c46d" name="c46d"><strong class="markup--strong markup--li-strong">Validation: </strong>If the hypothesis is confirmed, detail the threat and the scope of the incident.</li><li class="graf graf--li graf-after--li" id="a991" name="a991"><strong class="markup--strong markup--li-strong">Intervention</strong> : For confirmed threats, take immediate action. For example, a suspicious user’s account can be suspended, the system cleaned if malware is detected, or affected devices isolated from the network.</li><li class="graf graf--li graf-after--li" id="b4e9" name="b4e9"><strong class="markup--strong markup--li-strong">False Positive Management: </strong>Sort out false positives and re-evaluate the hypothesis.</li><li class="graf graf--li graf-after--li" id="27d1" name="27d1"><strong class="markup--strong markup--li-strong">New Hypotheses: </strong>After false positives, new hypotheses are created and the testing process continues.</li></ul><h4 class="graf graf--h4 graf-after--li" id="67ae" name="67ae">Continuous Improvement</h4><ul class="postList"><li class="graf graf--li graf-after--h4" id="0a23" name="0a23"><strong class="markup--strong markup--li-strong">Feedback Loop:</strong> It includes incorporating insights and feedback from the hypothesis testing process into future threat hunting activities.</li><li class="graf graf--li graf-after--li" id="9f9f" name="9f9f"><strong class="markup--strong markup--li-strong">Documentation and Reporting: </strong>It is the detailed documentation of hypothesis test results and response processes, shared with relevant stakeholders.</li></ul><h3 class="graf graf--h3 graf-after--li" id="a7f7" name="a7f7">Summary</h3><p class="graf graf--p graf-after--h3" id="4f1c" name="4f1c">This lesson explains how to conduct the hypothesis creation and testing process and what to pay attention to during these steps. These processes help develop an effective and proactive security strategy in threat hunting activities.</p><p class="graf graf--p graf-after--p" id="8f8d" name="8f8d">The next lesson will cover <strong class="markup--strong markup--p-strong">“Insider Threat Hypothesis”</strong> .</p><h3 class="graf graf--h3 graf-after--p" id="d4dd" name="d4dd">Questions</h3><p class="graf graf--p graf-after--h3 graf--trailing" id="c0b7" name="c0b7">No Anser Needed</p></div></div></section><section class="section section--body" name="5e84"><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading" id="1ba0" name="1ba0">Insider Threat Hypothesis</h3><h3 class="graf graf--h3 graf-after--h3" id="713a" name="713a">Hypothesis</h3><p class="graf graf--p graf--startsWithDoubleQuote graf-after--h3" id="cd4e" name="cd4e">“This hypothesis is based on the assumption that an employee might attempt to illegally exfiltrate sensitive information before leaving the company. The employee could intend to use this data for personal gain or to benefit another organization.“</p><p class="graf graf--p graf-after--p" id="8e75" name="8e75">After creating the hypothesis, the threat hunting process requires the following steps.</p><h3 class="graf graf--h3 graf-after--p" id="b017" name="b017">Collecting Data</h3><p class="graf graf--p graf-after--h3" id="1ea8" name="1ea8">SIEM systems have the ability to collect data from multiple sources. To test the validity of the hypothesis, collect all relevant data in this step.</p><h3 class="graf graf--h3 graf-after--p" id="22e3" name="22e3">User Activity Logs</h3><p class="graf graf--p graf-after--h3" id="fcf1" name="fcf1"><strong class="markup--strong markup--p-strong">Collect Login/Logout Logs: </strong>Gather information about when the user logged in and out of the system.</p><p class="graf graf--p graf-after--p" id="9215" name="9215">In the SIEM, filter activities of the relevant user accounts and analyze login/logout times.</p><p class="graf graf--p graf-after--p" id="15c8" name="15c8"><strong class="markup--strong markup--p-strong">Collect File Access Records: </strong>Gather information about which files the user accessed and when.</p><p class="graf graf--p graf-after--p" id="3cba" name="3cba">In the SIEM, examine file server logs and review file access activities of specific users.</p><h3 class="graf graf--h3 graf-after--p" id="f4c1" name="f4c1">Network Traffic Data</h3><p class="graf graf--p graf-after--h3" id="1a5c" name="1a5c"><strong class="markup--strong markup--p-strong">Collect FTP Traffic Logs: </strong>Gather FTP logs to check if the user performed large file transfers.</p><p class="graf graf--p graf-after--p" id="fed4" name="fed4">In the SIEM, examine network traffic logs and analyze large data transfers over the FTP protocol.</p><p class="graf graf--p graf-after--p" id="762b" name="762b"><strong class="markup--strong markup--p-strong">Collect Email Traffic Logs:</strong> Check whether the user sent large file attachments via email.</p><p class="graf graf--p graf-after--p" id="aacb" name="aacb">In the SIEM, analyze email server logs and filter emails containing large file attachments.</p><h3 class="graf graf--h3 graf-after--p" id="b53f" name="b53f">Endpoint Data</h3><p class="graf graf--p graf-after--h3" id="84dc" name="84dc"><strong class="markup--strong markup--p-strong">Collect USB Device Usage Logs: </strong>Check whether the user used USB devices to exfiltrate data.</p><p class="graf graf--p graf-after--p" id="5184" name="5184">In the SIEM, examine endpoint security software logs and review the times when USB devices were connected and disconnected.</p><p class="graf graf--p graf-after--p" id="8586" name="8586"><strong class="markup--strong markup--p-strong">Collect File Copy Activity Logs:</strong> Monitor the user’s file copy activities.</p><p class="graf graf--p graf-after--p" id="2059" name="2059">In the SIEM, analyze endpoint device logs and check for large file copy operations by specific users.</p><h3 class="graf graf--h3 graf-after--p" id="d279" name="d279">Data Analysis</h3><p class="graf graf--p graf-after--h3" id="3b3c" name="3b3c">Analyze the collected data in detail. Examine the abnormal behaviors and activities specified in the hypothesis.</p><h3 class="graf graf--h3 graf-after--p" id="f1f3" name="f1f3">Analyze User Activities</h3><p class="graf graf--p graf-after--h3" id="af06" name="af06">Review the user’s recent activities thoroughly.</p><p class="graf graf--p graf-after--p" id="92fb" name="92fb">In the SIEM, filter user activities by time range and examine them in detail.</p><p class="graf graf--p graf-after--p" id="5e48" name="5e48">Analyze the user’s file access and copy activities.</p><p class="graf graf--p graf-after--p" id="1561" name="1561">In the SIEM, examine file server and endpoint device logs, and compare file access and copy activities.</p><h3 class="graf graf--h3 graf-after--p" id="52d5" name="52d5">Correlation and Anomaly Detection</h3><p class="graf graf--p graf-after--h3" id="8c0b" name="8c0b">Correlate multiple data sources to detect anomalies and suspicious activity.</p><h3 class="graf graf--h3 graf-after--p" id="8634" name="8634">Unusual File Copying at Odd Hours</h3><p class="graf graf--p graf-after--h3" id="f31c" name="f31c">Determine if the user copied large amounts of data at unusual times.</p><p class="graf graf--p graf-after--p" id="27a3" name="27a3">In the SIEM, filter and examine large file copy operations during specific time frames.</p><h3 class="graf graf--h3 graf-after--p" id="59c2" name="59c2">Unusual Data Transfers</h3><p class="graf graf--p graf-after--h3" id="41d3" name="41d3">Search for unusual data transfers (e.g., large file uploads) in network traffic.</p><p class="graf graf--p graf-after--p" id="bb97" name="bb97">In the SIEM, analyze network traffic logs and detect large file transfers and unusual connections.</p><h3 class="graf graf--h3 graf-after--p" id="a3b4" name="a3b4">Validation and Conclusion</h3><p class="graf graf--p graf-after--h3" id="5bfb" name="5bfb">Validate the hypothesis. If confirmed, take necessary actions. If disproven, create new hypotheses and repeat the testing process.</p><h3 class="graf graf--h3 graf-after--p" id="91de" name="91de">Validate The Hypothesis</h3><p class="graf graf--p graf-after--h3" id="ceab" name="ceab">Confirm if the user copied a large amount of sensitive data before leaving the company and attempted to exfiltrate it.</p><p class="graf graf--p graf-after--p" id="8b1a" name="8b1a">In the SIEM, review the collected and analyzed data to confirm anomalies and activities that validate the hypothesis.</p><h3 class="graf graf--h3 graf-after--p" id="7ae4" name="7ae4">Respond Accordingly</h3><p class="graf graf--p graf-after--h3" id="fa0d" name="fa0d">Immediately suspend the user’s account if the hypothesis is validated.</p><p class="graf graf--p graf-after--p" id="107e" name="107e">In the SIEM, revoke the user account’s access and implement necessary security measures.</p><p class="graf graf--p graf-after--p" id="ca35" name="ca35">Initiate an internal investigation to examine the incident in detail.</p><p class="graf graf--p graf-after--p" id="511c" name="511c">In the SIEM, thoroughly review and report all relevant logs and event records.</p><h3 class="graf graf--h3 graf-after--p" id="98c3" name="98c3">Disproven Hypothesis &amp; New Hypothesis Creation</h3><p class="graf graf--p graf-after--h3" id="dff6" name="dff6">If the hypothesis is disproven, create new hypotheses and repeat the testing process.</p><p class="graf graf--p graf-after--p" id="2e82" name="2e82">In the SIEM, develop additional hypotheses for new anomalies and suspicious activities, and initiate new threat hunting processes based on these hypotheses.</p><h3 class="graf graf--h3 graf-after--p" id="0c51" name="0c51">Summary</h3><p class="graf graf--p graf-after--h3" id="04a4" name="04a4">These steps detail how to test and validate the insider threat detection hypothesis using SIEM. Following this process will help your organization to be better prepared and more proactive against insider threats.</p><p class="graf graf--p graf-after--p" id="3581" name="3581">The next lesson will cover <strong class="markup--strong markup--p-strong">“Suspicious Admin Account Activity Hypothesis”</strong>.</p><h3 class="graf graf--h3 graf-after--p" id="d47a" name="d47a">Questions</h3><p class="graf graf--p graf-after--h3 graf--trailing" id="5a37" name="5a37">No Anser Needed</p></div></div></section><section class="section section--body" name="fdc0"><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading" id="936c" name="936c">Suspicious Admin Account Activity Hypothesis</h3><h3 class="graf graf--h3 graf-after--h3" id="3725" name="3725">The Hypothesis</h3><p class="graf graf--p graf--startsWithDoubleQuote graf-after--h3" id="289a" name="289a">“An attacker may have compromised an admin account to gain access to critical systems.”</p><figure class="graf graf--figure graf-after--p" id="453c" name="453c"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="925" data-image-id="0*lUJJmMsCH5EQIDN4.png" data-width="1964" src="https://cdn-images-1.medium.com/max/800/0*lUJJmMsCH5EQIDN4.png"/><figcaption class="imageCaption">( <strong class="markup--strong markup--figure-strong">Image Source</strong> : <a class="markup--anchor markup--figure-anchor" data-href="https://blog.admindroid.com/enable-report-suspicious-activity-in-azure-ad/" href="https://blog.admindroid.com/enable-report-suspicious-activity-in-azure-ad/" rel="noopener noreferrer noopener noopener" target="_blank">https://blog.admindroid.com/enable-report-suspicious-activity-in-azure-ad/</a> )</figcaption></figure><h3 class="graf graf--h3 graf-after--figure" id="4691" name="4691">Data Resources</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="67c6" name="67c6"><strong class="markup--strong markup--li-strong">SIEM Logs:</strong> All relevant logs collected through the central log management system.</li><li class="graf graf--li graf-after--li" id="5940" name="5940"><strong class="markup--strong markup--li-strong">Operating System Logs: </strong>System events and user activities.</li><li class="graf graf--li graf-after--li" id="4e27" name="4e27"><strong class="markup--strong markup--li-strong">Account Management Logs: </strong>User and group changes, password changes.</li><li class="graf graf--li graf-after--li" id="74c9" name="74c9"><strong class="markup--strong markup--li-strong">Active Directory (AD) Logs: </strong>User and group changes in Active Directory.</li><li class="graf graf--li graf-after--li" id="1610" name="1610"><strong class="markup--strong markup--li-strong">Firewall Logs: </strong>Inbound and outbound network traffic.</li><li class="graf graf--li graf-after--li" id="52ea" name="52ea"><strong class="markup--strong markup--li-strong">Endpoint Detection and Response (EDR) Logs:</strong> Records of abnormal activities on endpoints.</li><li class="graf graf--li graf-after--li" id="1dfe" name="1dfe"><strong class="markup--strong markup--li-strong">Threat Intelligence Databases:</strong> Known malicious IP addresses and domains.</li></ul><h3 class="graf graf--h3 graf-after--li" id="29a1" name="29a1">Analysis Steps</h3><h4 class="graf graf--h4 graf-after--h3" id="8815" name="8815">Admin Login Attempts</h4><ul class="postList"><li class="graf graf--li graf-after--h4" id="9218" name="9218"><strong class="markup--strong markup--li-strong">Failed Logins: </strong>Detect failed login attempts for admin accounts.</li><li class="graf graf--li graf-after--li" id="50b5" name="50b5"><strong class="markup--strong markup--li-strong">Successful Logins: </strong>Check for successful logins following failed attempts.</li></ul><h4 class="graf graf--h4 graf-after--li" id="1cdc" name="1cdc">Account Management Activity</h4><ul class="postList"><li class="graf graf--li graf-after--h4" id="9ac0" name="9ac0"><strong class="markup--strong markup--li-strong">Permission Changes:</strong> Monitor changes in user and group permissions.</li><li class="graf graf--li graf-after--li" id="ed2d" name="ed2d"><strong class="markup--strong markup--li-strong">Password Changes:</strong> Check for password changes on admin accounts.</li><li class="graf graf--li graf-after--li" id="34a4" name="34a4"><strong class="markup--strong markup--li-strong">Account Creation/Deletion:</strong> Monitor unexpected user or group creation/deletion activities.</li></ul><h4 class="graf graf--h4 graf-after--li" id="8338" name="8338">Network Traffic and Connection</h4><ul class="postList"><li class="graf graf--li graf-after--h4" id="c5bb" name="c5bb"><strong class="markup--strong markup--li-strong">Abnormal Traffic:</strong> Monitor abnormal connections initiated by admin accounts.</li><li class="graf graf--li graf-after--li" id="f463" name="f463"><strong class="markup--strong markup--li-strong">New Targets:</strong> Check for connections to IP addresses previously not accessed by admin accounts.</li><li class="graf graf--li graf-after--li" id="cef8" name="cef8"><strong class="markup--strong markup--li-strong">Port Usage:</strong> Monitor connections made through unexpected ports.</li></ul><h4 class="graf graf--h4 graf-after--li" id="5c60" name="5c60">Analysis of EDR Logs</h4><ul class="postList"><li class="graf graf--li graf-after--h4" id="4f76" name="4f76"><strong class="markup--strong markup--li-strong">Abnormal Processes:</strong> Monitor unusual processes running on endpoints.</li><li class="graf graf--li graf-after--li" id="d6f1" name="d6f1"><strong class="markup--strong markup--li-strong">Admin Privileges:</strong> Monitor abnormal activities by processes with admin privileges.</li><li class="graf graf--li graf-after--li" id="92fc" name="92fc"><strong class="markup--strong markup--li-strong">Malware:</strong> Check for malware detected by antivirus and antimalware software.</li></ul><h4 class="graf graf--h4 graf-after--li" id="aff4" name="aff4">Analysis of Active Directory Logs</h4><ul class="postList"><li class="graf graf--li graf-after--h4" id="416e" name="416e"><strong class="markup--strong markup--li-strong">Critical Changes:</strong> Monitor critical changes in AD (e.g., group policy changes, account lockouts).</li><li class="graf graf--li graf-after--li" id="8f4a" name="8f4a"><strong class="markup--strong markup--li-strong">Login Attempts:</strong> Check login attempts on admin accounts in AD.</li></ul><h4 class="graf graf--h4 graf-after--li" id="2bb4" name="2bb4">Threat Intelligence Integration</h4><ul class="postList"><li class="graf graf--li graf-after--h4" id="b994" name="b994"><strong class="markup--strong markup--li-strong">Known Malicious IPs:</strong> Compare IP addresses connected by admin accounts with threat intelligence databases.</li><li class="graf graf--li graf-after--li" id="55a2" name="55a2"><strong class="markup--strong markup--li-strong">Domain Reputation:</strong> Check the reputation of domains accessed by admin accounts.</li></ul><h4 class="graf graf--h4 graf-after--li" id="0c44" name="0c44">Expected Results</h4><ul class="postList"><li class="graf graf--li graf-after--h4" id="66c4" name="66c4">Failed login attempts on admin accounts followed by successful logins.</li><li class="graf graf--li graf-after--li" id="4185" name="4185">Unexpected changes in user and group permissions.</li><li class="graf graf--li graf-after--li" id="5694" name="5694">Abnormal network connections initiated by admin accounts.</li><li class="graf graf--li graf-after--li" id="c66d" name="c66d">Abnormal processes or file activities on endpoints.</li><li class="graf graf--li graf-after--li" id="0b8a" name="0b8a">Critical changes and unexpected login attempts in AD.</li><li class="graf graf--li graf-after--li" id="36d1" name="36d1">Access to known malicious IP addresses or domains.</li></ul><h3 class="graf graf--h3 graf-after--li" id="8352" name="8352">Summary</h3><p class="graf graf--p graf-after--h3" id="ac25" name="ac25">SIEM systems support threat hunting processes within specific hypotheses and provide powerful tools for detecting suspicious admin account activity. The steps outlined in this lesson demonstrate how SIEM can be used to detect unauthorized access attempts to administrator accounts. The process helps organizations proactively manage their cybersecurity posture and become more resilient to potential threats.</p><h3 class="graf graf--h3 graf-after--p" id="2703" name="2703">Questions</h3><p class="graf graf--p graf-after--h3 graf--trailing" id="d340" name="d340">No Anser Needed</p></div></div></section><section class="section section--body" name="6bd3"><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading" id="69a2" name="69a2">Practical Lab-1</h3><h3 class="graf graf--h3 graf-after--h3" id="9ada" name="9ada">Hypothesis-1</h3><p class="graf graf--p graf-after--h3" id="0304" name="0304"><strong class="markup--strong markup--p-strong">Note: </strong>The questions in this section are aimed at conducting Threat Hunting based on the following hypothesis.</p><p class="graf graf--p graf-after--p" id="1f6f" name="1f6f"><strong class="markup--strong markup--p-strong">Hypothesis: </strong>There may be attempts to access unauthorized servers and ports from a Linux server located in the DMZ environment.</p><h3 class="graf graf--h3 graf-after--p" id="830f" name="830f">Threat Hunting Lab Environment</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="33ec" name="33ec"><strong class="markup--strong markup--li-strong">DMZ Server IP Block</strong>: 172.16.8.0/24</li><li class="graf graf--li graf-after--li" id="8c4a" name="8c4a"><strong class="markup--strong markup--li-strong">Other Networks</strong>: 10.10.10.0/24</li><li class="graf graf--li graf-after--li" id="a680" name="a680">SIEM (Wazuh)</li><li class="graf graf--li graf-after--li" id="14c7" name="14c7">Firewall Traffic Events</li><li class="graf graf--li graf-after--li" id="3a53" name="3a53">Firewall System Events</li><li class="graf graf--li graf-after--li" id="4cd6" name="4cd6">Linux Security Events</li><li class="graf graf--li graf-after--li" id="26e4" name="26e4">Linux Audit Events</li><li class="graf graf--li graf-after--li" id="b701" name="b701">Linux Yum Events</li></ul><h3 class="graf graf--h3 graf-after--li" id="e71f" name="e71f">Questions</h3><blockquote class="graf graf--blockquote graf-after--h3" id="c14b" name="c14b"><strong class="markup--strong markup--blockquote-strong">According to firewall logs, what is the “log_id” value of the firewall rule added between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="7cd9" name="7cd9">When we do the necessary filtering for firewall logs in the system, we find the logid value.</p><figure class="graf graf--figure graf-after--p" id="0289" name="0289"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="752" data-image-id="1*gic-ndoay-0M_G-dlcvSYw.png" data-width="2084" src="https://cdn-images-1.medium.com/max/800/1*gic-ndoay-0M_G-dlcvSYw.png"/></figure><p class="graf graf--p graf-after--figure" id="62e5" name="62e5"><strong class="markup--strong markup--p-strong">Answer: </strong>13579</p><figure class="graf graf--figure graf-after--p" id="e76d" name="e76d"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="113" data-image-id="1*kx41JqzXoJTxeQuyvR_ROQ.png" data-width="1218" src="https://cdn-images-1.medium.com/max/800/1*kx41JqzXoJTxeQuyvR_ROQ.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="5d38" name="5d38"><strong class="markup--strong markup--blockquote-strong">According to firewall logs, which user allowed access to the IP address “172.16.8.190” on port 22 between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="46f2" name="46f2">If we look carefully at the log we found in the previous question, we observe that there are 22 SSH access requests. the user value asked to us is also in the log.</p><figure class="graf graf--figure graf-after--p" id="a214" name="a214"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="216" data-image-id="1*Ikvc0ow8S12lW7P3g16-Vw.png" data-width="1700" src="https://cdn-images-1.medium.com/max/800/1*Ikvc0ow8S12lW7P3g16-Vw.png"/></figure><p class="graf graf--p graf-after--figure" id="de40" name="de40"><strong class="markup--strong markup--p-strong">Answer: </strong>fwadmin</p><figure class="graf graf--figure graf-after--p" id="2e2d" name="2e2d"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="119" data-image-id="1*Kts9_EcqCAEUgwIEw4fA7Q.png" data-width="1369" src="https://cdn-images-1.medium.com/max/800/1*Kts9_EcqCAEUgwIEw4fA7Q.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="e249" name="e249"><strong class="markup--strong markup--blockquote-strong">According to DMZ server logs, how many “sshd: authentication failed.” events occurred between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="0647" name="0647">We understand that 172.16.8 IPs are DMZ assests. Let’s search for ssh fail events to these hosts. For this we need to search for sshd group and authentication_failed event. When we write the necessary filters, we find the answer as 24 hits.</p><figure class="graf graf--figure graf-after--p" id="f03a" name="f03a"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="790" data-image-id="1*4xh57yWlMzfXhJqY3NVt_A.png" data-width="2071" src="https://cdn-images-1.medium.com/max/800/1*4xh57yWlMzfXhJqY3NVt_A.png"/></figure><p class="graf graf--p graf-after--figure" id="1b16" name="1b16"><strong class="markup--strong markup--p-strong">Answer: </strong>24</p><figure class="graf graf--figure graf-after--p" id="ee3d" name="ee3d"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="110" data-image-id="1*uCQ_Jh-GRgg5GZ2yQAZI9A.png" data-width="1305" src="https://cdn-images-1.medium.com/max/800/1*uCQ_Jh-GRgg5GZ2yQAZI9A.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="b0cb" name="b0cb"><strong class="markup--strong markup--blockquote-strong">According to DMZ server logs, what is the IP address that successfully logged in (sshd: authentication success) after a failed attempt (sshd: authentication failed) between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="6dd8" name="6dd8">in the previous question we saw that 172.16.8.190 host received a large number of ssh auth failures. now let’s look at the auth succces logs. in the auth succes logs we see that 172.16.8.190 host was connected to 172.16.8.190 host by receiving success after a large number of ssh failures. we determine the source IP information as 12.13.14.15.</p><figure class="graf graf--figure graf-after--p" id="ae54" name="ae54"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="779" data-image-id="1*JDRNNg4vAGzUJSRheFW18g.png" data-width="2050" src="https://cdn-images-1.medium.com/max/800/1*JDRNNg4vAGzUJSRheFW18g.png"/></figure><p class="graf graf--p graf-after--figure" id="9442" name="9442"><strong class="markup--strong markup--p-strong">Answer: </strong>12.13.14.15</p><figure class="graf graf--figure graf-after--p" id="a24f" name="a24f"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="134" data-image-id="1*MmKXW-ITd4XY91aUFBgWhg.png" data-width="1533" src="https://cdn-images-1.medium.com/max/800/1*MmKXW-ITd4XY91aUFBgWhg.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="679c" name="679c"><strong class="markup--strong markup--blockquote-strong">What application was installed on the webserver with IP address “172.16.8.190” in the DMZ environment after unauthorized access between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="60c0" name="60c0">When we search for the relevant agent ip in the yum group, we get a result and when we look at the full log content in this result, we observe that nmap is installed on the host.</p><figure class="graf graf--figure graf-after--p" id="19a1" name="19a1"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="766" data-image-id="1*i4kRvCiG1YgZGg-I74j4gQ.png" data-width="2067" src="https://cdn-images-1.medium.com/max/800/1*i4kRvCiG1YgZGg-I74j4gQ.png"/></figure><p class="graf graf--p graf-after--figure" id="e3a4" name="e3a4"><strong class="markup--strong markup--p-strong">Answer: </strong>nmap-6.40–19.el7.x86_64</p><figure class="graf graf--figure graf-after--p" id="db80" name="db80"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="172" data-image-id="1*eAe-igWD4N4j-JLxfhHW_w.png" data-width="1582" src="https://cdn-images-1.medium.com/max/800/1*eAe-igWD4N4j-JLxfhHW_w.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="3bce" name="3bce"><strong class="markup--strong markup--blockquote-strong">What IP block was scanned using the application installed after unauthorized access to the webserver with IP address “172.16.8.190” in the DMZ environment between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="8e18" name="8e18">When we filter by agent.name and search for nmap activities, we find the subnet information scanned in the audit logs.</p><figure class="graf graf--figure graf-after--p" id="4526" name="4526"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="819" data-image-id="1*Ofx0mBiHu7ZECUns4ERtrQ.png" data-width="2053" src="https://cdn-images-1.medium.com/max/800/1*Ofx0mBiHu7ZECUns4ERtrQ.png"/></figure><p class="graf graf--p graf-after--figure" id="6721" name="6721"><strong class="markup--strong markup--p-strong">Answer: </strong>10.10.10.0/24</p><figure class="graf graf--figure graf-after--p" id="fd3b" name="fd3b"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="140" data-image-id="1*VE5LZ4nnxc3s_Pvwz5LCHQ.png" data-width="1503" src="https://cdn-images-1.medium.com/max/800/1*VE5LZ4nnxc3s_Pvwz5LCHQ.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="8248" name="8248"><strong class="markup--strong markup--blockquote-strong">What is the number of the port that was scanned using the application that was installed after the unauthorized access to the web server with the IP address “172.16.8.190” in the DMZ environment between August 1, 2024 00:00 — August 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="3948" name="3948">Again in the same log content, we see that the port information scanned is 22 ssh port.</p><figure class="graf graf--figure graf-after--p" id="83e9" name="83e9"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="220" data-image-id="1*9ybv94n_n1-pwVeGPqrdiQ.png" data-width="1669" src="https://cdn-images-1.medium.com/max/800/1*9ybv94n_n1-pwVeGPqrdiQ.png"/></figure><p class="graf graf--p graf-after--figure" id="33ea" name="33ea"><strong class="markup--strong markup--p-strong">Answer: </strong>22</p><figure class="graf graf--figure graf-after--p" id="52dd" name="52dd"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="140" data-image-id="1*gKvAxV8XHw2AHAGKtUHBFg.png" data-width="1512" src="https://cdn-images-1.medium.com/max/800/1*gKvAxV8XHw2AHAGKtUHBFg.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="7dae" name="7dae"><strong class="markup--strong markup--blockquote-strong">According to firewall logs, how many unique destination IP addresses received “accept/allow” traffic from the IP address “172.16.8.190” to the “10.10.10.0/24” network between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="b773" name="b773">When we filter the allow fields from 22 ssh requests from 172.16.8.190 source ip in the firewall group, we see that there are 4 hits.</p><figure class="graf graf--figure graf-after--p" id="dc80" name="dc80"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="819" data-image-id="1*z793CO0Aj9gHGXyAZzWRtA.png" data-width="2070" src="https://cdn-images-1.medium.com/max/800/1*z793CO0Aj9gHGXyAZzWRtA.png"/></figure><p class="graf graf--p graf-after--figure" id="80be" name="80be"><strong class="markup--strong markup--p-strong">Answer: </strong>4</p><figure class="graf graf--figure graf-after--p" id="387c" name="387c"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="123" data-image-id="1*7vczN-m10e6vCx5CKs6XWA.png" data-width="1556" src="https://cdn-images-1.medium.com/max/800/1*7vczN-m10e6vCx5CKs6XWA.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="547c" name="547c"><strong class="markup--strong markup--blockquote-strong">According to firewall logs, how many “SSH authentication_failed” events occurred from the IP address “172.16.8.190” to the “10.10.10.0/24” network between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="1aa9" name="1aa9">We can find this answer from sshd logs, not firewall logs. there seems to be a mistake in the question. when we look at auth fail events from ssh logs, we can see that it received 8 fail.</p><figure class="graf graf--figure graf-after--p" id="e8c1" name="e8c1"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="855" data-image-id="1*tRkYMuRdpQbEjKdLsm_SAw.png" data-width="1973" src="https://cdn-images-1.medium.com/max/800/1*tRkYMuRdpQbEjKdLsm_SAw.png"/></figure><p class="graf graf--p graf-after--figure" id="b1d9" name="b1d9"><strong class="markup--strong markup--p-strong">Answer: </strong>8</p><figure class="graf graf--figure graf-after--p" id="9c5b" name="9c5b"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="136" data-image-id="1*L1Gobb0NR84TXPAKLkxRxw.png" data-width="1541" src="https://cdn-images-1.medium.com/max/800/1*L1Gobb0NR84TXPAKLkxRxw.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="a8d3" name="a8d3"><strong class="markup--strong markup--blockquote-strong">What is the IP address of the system in the “10.10.10.0/24” network that successfully logged in via SSH (authentication_success) from the IP address “172.16.8.190” between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="caff" name="caff">If we search for success events instead of fail using the same filter, we get 1 hit. in this event, agent ip information is our answer.</p><figure class="graf graf--figure graf-after--p" id="e6ea" name="e6ea"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="712" data-image-id="1*k46XKIhfXzcww5UIwcfs3g.png" data-width="2081" src="https://cdn-images-1.medium.com/max/800/1*k46XKIhfXzcww5UIwcfs3g.png"/></figure><p class="graf graf--p graf-after--figure" id="4cb4" name="4cb4"><strong class="markup--strong markup--p-strong">Answer: </strong>10.10.10.24</p><figure class="graf graf--figure graf-after--p graf--trailing" id="3a96" name="3a96"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="135" data-image-id="1*kH-37eWANC5YG25iZGALhw.png" data-width="1530" src="https://cdn-images-1.medium.com/max/800/1*kH-37eWANC5YG25iZGALhw.png"/></figure></div></div></section><section class="section section--body" name="6786"><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading" id="0163" name="0163">Practical Lab-2</h3><h3 class="graf graf--h3 graf-after--h3" id="a513" name="a513">Hypothesis-2</h3><p class="graf graf--p graf-after--h3" id="47bf" name="47bf"><strong class="markup--strong markup--p-strong">Note: </strong>The questions in this section are aimed at conducting Threat Hunting based on the following hypothesis.</p><p class="graf graf--p graf-after--p" id="8215" name="8215"><strong class="markup--strong markup--p-strong">Hypothesis: </strong>User accounts with VPN access may have been compromised, and unauthorized access attempts may be occurring.</p><h3 class="graf graf--h3 graf-after--p" id="be7d" name="be7d">Threat Hunting Lab Environment</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="815a" name="815a">SIEM (Wazuh)</li><li class="graf graf--li graf-after--li" id="ad07" name="ad07">Firewall Traffic Events</li><li class="graf graf--li graf-after--li" id="c29e" name="c29e">VPN Events</li></ul><h3 class="graf graf--h3 graf-after--li" id="67c7" name="67c7">Questions</h3><blockquote class="graf graf--blockquote graf-after--h3" id="5881" name="5881"><strong class="markup--strong markup--blockquote-strong">What is the username with the most SSL VPN login failures between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="11dc" name="11dc">If we filter vpn subtype and auth fail events in firewall logs, we will reach the answer.</p><figure class="graf graf--figure graf-after--p" id="bb99" name="bb99"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="877" data-image-id="1*0iuUMF-O_zPPvvTUqFarpA.png" data-width="1847" src="https://cdn-images-1.medium.com/max/800/1*0iuUMF-O_zPPvvTUqFarpA.png"/></figure><p class="graf graf--p graf-after--figure" id="97b4" name="97b4"><strong class="markup--strong markup--p-strong">Answer: </strong>adm_eric</p><figure class="graf graf--figure graf-after--p" id="63c5" name="63c5"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="114" data-image-id="1*MbO7wHQAWqCda3Wo8ZN1FQ.png" data-width="1031" src="https://cdn-images-1.medium.com/max/800/1*MbO7wHQAWqCda3Wo8ZN1FQ.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="bcd3" name="bcd3"><strong class="markup--strong markup--blockquote-strong">Apart from Germany, which country had successful logins for the VPN account with the most SSL VPN login failures between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="db76" name="db76">For the adm_eric account, we need to find out from which country outside of Germany the successful login was made. for this we need to filter the account and aut success.</p><figure class="graf graf--figure graf-after--p" id="2997" name="2997"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="723" data-image-id="1*u94Hu0GERjlEjBC37CAEIg.png" data-width="1696" src="https://cdn-images-1.medium.com/max/800/1*u94Hu0GERjlEjBC37CAEIg.png"/></figure><p class="graf graf--p graf-after--figure" id="a77a" name="a77a"><strong class="markup--strong markup--p-strong">Answer: </strong>Mexico</p><figure class="graf graf--figure graf-after--p" id="69d9" name="69d9"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="106" data-image-id="1*szFgQqiUtWSWnyr89B7vtQ.png" data-width="1567" src="https://cdn-images-1.medium.com/max/800/1*szFgQqiUtWSWnyr89B7vtQ.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="bb73" name="bb73"><strong class="markup--strong markup--blockquote-strong">What “tunnel_ip” was assigned after a successful login (excluding Germany) for the VPN account with the most SSL VPN login failures between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="8c71" name="8c71">In the previous question, when we examine the success log originating from mexico, we reach the tunnelip value when we examine the full log content in the relevant log.</p><figure class="graf graf--figure graf-after--p" id="e433" name="e433"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="213" data-image-id="1*KJePJ1yb2PeRV4YUgCONhw.png" data-width="1393" src="https://cdn-images-1.medium.com/max/800/1*KJePJ1yb2PeRV4YUgCONhw.png"/></figure><p class="graf graf--p graf-after--figure" id="5eb8" name="5eb8"><strong class="markup--strong markup--p-strong">Answer: </strong>10.34.1.13</p><figure class="graf graf--figure graf-after--p" id="1aa3" name="1aa3"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="111" data-image-id="1*jFLuhbZli4d5AlLaK8pazA.png" data-width="1739" src="https://cdn-images-1.medium.com/max/800/1*jFLuhbZli4d5AlLaK8pazA.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="b17b" name="b17b"><strong class="markup--strong markup--blockquote-strong">According to traffic logs, what is the most frequently accessed destination port from the “tunnel_ip” assigned after a successful login (excluding Germany) for the VPN account with the most SSL VPN login failures between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="3b10" name="3b10">For this, we need to filter the traffic originating from the address 10.34.1.13 that we find in the firewall logs. Then, when we look at the dstport field, we can find out which port the outgoing traffic is most targeted.</p><figure class="graf graf--figure graf-after--p" id="9385" name="9385"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="725" data-image-id="1*gm5EHuxGTLVKaYq4ugKa3g.png" data-width="1802" src="https://cdn-images-1.medium.com/max/800/1*gm5EHuxGTLVKaYq4ugKa3g.png"/></figure><p class="graf graf--p graf-after--figure" id="6e55" name="6e55"><strong class="markup--strong markup--p-strong">Answer: </strong>22</p><figure class="graf graf--figure graf-after--p" id="ce97" name="ce97"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="139" data-image-id="1*GgvFqp5XqwRX-TO8QBMLfw.png" data-width="1554" src="https://cdn-images-1.medium.com/max/800/1*GgvFqp5XqwRX-TO8QBMLfw.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="cc9b" name="cc9b"><strong class="markup--strong markup--blockquote-strong">How many unique destinations had SSH service access allowed via the “tunnel_ip” assigned after a successful login (excluding Germany) for the VPN account with the most SSL VPN login failures between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="bb36" name="bb36">For this, we need to filter the ‘action allow’ fields from the 10.34.1.13 IP addresses and the 22-port targeted traffic. The number of hits will then provide the answer.</p><figure class="graf graf--figure graf-after--p" id="aab2" name="aab2"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="870" data-image-id="1*0y4OPg_0OZ0nIKeZH7-O6w.png" data-width="1701" src="https://cdn-images-1.medium.com/max/800/1*0y4OPg_0OZ0nIKeZH7-O6w.png"/></figure><p class="graf graf--p graf-after--figure" id="ee1f" name="ee1f"><strong class="markup--strong markup--p-strong">Answer: </strong>3</p><figure class="graf graf--figure graf-after--p" id="dbff" name="dbff"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="131" data-image-id="1*DNm0sfXfxNmv1b9ckHZpnQ.png" data-width="1574" src="https://cdn-images-1.medium.com/max/800/1*DNm0sfXfxNmv1b9ckHZpnQ.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="2c59" name="2c59"><strong class="markup--strong markup--blockquote-strong">What IP address received an ssh auth success from the “tunnel_ip” assigned after a successful login (excluding Germany) for the VPN account with the most SSL VPN login failures between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="9d1a" name="9d1a">To do this, we need to look at the SSHD logs. Filtering the successful SSH logins by source IP address will reveal which host has logged in successfully via the agent.ip field.</p><figure class="graf graf--figure graf-after--p" id="6c6d" name="6c6d"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="667" data-image-id="1*GsIzZ-MKcm-SXhV05RrzhA.png" data-width="1837" src="https://cdn-images-1.medium.com/max/800/1*GsIzZ-MKcm-SXhV05RrzhA.png"/></figure><p class="graf graf--p graf-after--figure" id="ee78" name="ee78"><strong class="markup--strong markup--p-strong">Answer: </strong>10.10.10.11</p><figure class="graf graf--figure graf-after--p" id="6fce" name="6fce"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="136" data-image-id="1*fTCDRmf2vNNY8D3mPtb6Xw.png" data-width="1542" src="https://cdn-images-1.medium.com/max/800/1*fTCDRmf2vNNY8D3mPtb6Xw.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="406c" name="406c"><strong class="markup--strong markup--blockquote-strong">What command was executed for the “T1057-Process Discovery” activity after successful SSH access from the “tunnel_ip” assigned after a successful login (excluding Germany) for the VPN account with the most SSL VPN login failures between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="f337" name="f337">For this, we should look at the audit logs. When we filter with agent.name, we can find the commands running on the host.</p><figure class="graf graf--figure graf-after--p" id="801f" name="801f"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="754" data-image-id="1*8ge_N2yB10CjjjOfKAl99Q.png" data-width="1797" src="https://cdn-images-1.medium.com/max/800/1*8ge_N2yB10CjjjOfKAl99Q.png"/></figure><p class="graf graf--p graf-after--figure" id="3e49" name="3e49"><strong class="markup--strong markup--p-strong">Answer: </strong>ps</p><figure class="graf graf--figure graf-after--p" id="7daa" name="7daa"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="129" data-image-id="1*SQaYw4UT5oth9mrSyb8z-Q.png" data-width="1578" src="https://cdn-images-1.medium.com/max/800/1*SQaYw4UT5oth9mrSyb8z-Q.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="0726" name="0726"><strong class="markup--strong markup--blockquote-strong">Which process was searched for during the “T1057-Process Discovery” activity after successful SSH access from the “tunnel_ip” assigned after a successful login (excluding Germany) for the VPN account with the most SSL VPN login failures between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="e5fd" name="e5fd">When we look at the full log in detail, we see that the “ps -aux | grep proftp” “command is executed.</p><figure class="graf graf--figure graf-after--p" id="19cb" name="19cb"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="387" data-image-id="1*a7L0ckeu5IvmSA67j5TT3g.png" data-width="1238" src="https://cdn-images-1.medium.com/max/800/1*a7L0ckeu5IvmSA67j5TT3g.png"/></figure><p class="graf graf--p graf-after--figure" id="385e" name="385e"><strong class="markup--strong markup--p-strong">Answer: </strong>proftp</p><figure class="graf graf--figure graf-after--p graf--trailing" id="e8c5" name="e8c5"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="131" data-image-id="1*JrcF4Hc77iZaPrIANHWRvQ.png" data-width="1512" src="https://cdn-images-1.medium.com/max/800/1*JrcF4Hc77iZaPrIANHWRvQ.png"/></figure></div></div></section><section class="section section--body section--last" name="f6ad"><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 class="graf graf--h3 graf--leading" id="54b0" name="54b0">Practical Lab-3</h3><h3 class="graf graf--h3 graf-after--h3" id="0e0a" name="0e0a">Hypothesis-3</h3><p class="graf graf--p graf-after--h3" id="a9e4" name="a9e4"><strong class="markup--strong markup--p-strong">Note: </strong>The questions in this section are aimed at conducting Threat Hunting based on the following hypothesis.</p><p class="graf graf--p graf-after--p" id="f5c9" name="f5c9"><strong class="markup--strong markup--p-strong">Hypothesis: </strong>Misconfigured FTP services on a server in the DMZ environment may have left anonymous user accounts open, potentially allowing unauthorized file uploads and downloads.</p><h3 class="graf graf--h3 graf-after--p" id="215e" name="215e">Threat Hunting Lab Environment</h3><ul class="postList"><li class="graf graf--li graf-after--h3" id="c922" name="c922"><strong class="markup--strong markup--li-strong">DMZ Server IP Block</strong> : 172.16.8.0/24</li><li class="graf graf--li graf-after--li" id="cb51" name="cb51">SIEM (Wazuh)</li><li class="graf graf--li graf-after--li" id="4038" name="4038">FTP Events</li><li class="graf graf--li graf-after--li" id="6bd9" name="6bd9">Linux System Events</li><li class="graf graf--li graf-after--li" id="9ed1" name="9ed1">Linux Security Events</li><li class="graf graf--li graf-after--li" id="c478" name="c478">Linux Audit Events</li></ul><h3 class="graf graf--h3 graf-after--li" id="66c3" name="66c3">Questions</h3><blockquote class="graf graf--blockquote graf-after--h3" id="3e3b" name="3e3b"><strong class="markup--strong markup--blockquote-strong">What is the IP address that successfully logged in as anonymous via FTP between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="dce4" name="dce4">we can find with this filter.</p><figure class="graf graf--figure graf-after--p" id="baf2" name="baf2"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="681" data-image-id="1*mxlLJQ5_KBeC1FKXDvs3tg.png" data-width="1790" src="https://cdn-images-1.medium.com/max/800/1*mxlLJQ5_KBeC1FKXDvs3tg.png"/></figure><p class="graf graf--p graf-after--figure" id="fe6d" name="fe6d"><strong class="markup--strong markup--p-strong">Answer: </strong>111.1.2.3</p><figure class="graf graf--figure graf-after--p" id="68d2" name="68d2"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="114" data-image-id="1*PVx5AEpyYTXq2s31eefx-A.png" data-width="1168" src="https://cdn-images-1.medium.com/max/800/1*PVx5AEpyYTXq2s31eefx-A.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="9e02" name="9e02"><strong class="markup--strong markup--blockquote-strong">What is the “country name” of the IP address that successfully logged in as anonymous via FTP between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="52bb" name="52bb">If we search the GeoLocation.country_name information in the log we find, we find the answer. Or you can sarch in the full log.</p><figure class="graf graf--figure graf-after--p" id="b6c9" name="b6c9"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="187" data-image-id="1*0SVCvuWZTTxOk1jHEbO-aQ.png" data-width="1422" src="https://cdn-images-1.medium.com/max/800/1*0SVCvuWZTTxOk1jHEbO-aQ.png"/></figure><p class="graf graf--p graf-after--figure" id="f0e7" name="f0e7"><strong class="markup--strong markup--p-strong">Answer: </strong>China</p><figure class="graf graf--figure graf-after--p" id="83d7" name="83d7"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="159" data-image-id="1*NFB4U4m2aQh5LT8SwgJfAA.png" data-width="1493" src="https://cdn-images-1.medium.com/max/800/1*NFB4U4m2aQh5LT8SwgJfAA.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="68d8" name="68d8"><strong class="markup--strong markup--blockquote-strong">What is the IP address of the system that allowed anonymous FTP logins between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="0770" name="0770">If we search the agent.ip information in the log we find, we find the answer.</p><figure class="graf graf--figure graf-after--p" id="47fa" name="47fa"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="178" data-image-id="1*vb0pwafIW15pl1iJOV9edw.png" data-width="1779" src="https://cdn-images-1.medium.com/max/800/1*vb0pwafIW15pl1iJOV9edw.png"/></figure><p class="graf graf--p graf-after--figure" id="9042" name="9042"><strong class="markup--strong markup--p-strong">Answer: </strong>172.16.8.21</p><figure class="graf graf--figure graf-after--p" id="3f41" name="3f41"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="141" data-image-id="1*29aRwlhh7jd8A7xlprDNTw.png" data-width="1406" src="https://cdn-images-1.medium.com/max/800/1*29aRwlhh7jd8A7xlprDNTw.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="8e52" name="8e52"><strong class="markup--strong markup--blockquote-strong">What is the name of the FTP service running on the system that allowed anonymous logins between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="dab7" name="dab7">we can see the answer from the full log content.</p><p class="graf graf--p graf-after--p" id="67a3" name="67a3"><strong class="markup--strong markup--p-strong">Answer: </strong>proftpd</p><figure class="graf graf--figure graf-after--p" id="802a" name="802a"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="153" data-image-id="1*LkcDV8wSduIagbs8eige4g.png" data-width="1464" src="https://cdn-images-1.medium.com/max/800/1*LkcDV8wSduIagbs8eige4g.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="000d" name="000d"><strong class="markup--strong markup--blockquote-strong">When was the FTP service restarted on the system that allowed anonymous logins between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="406e" name="406e">Searching for the text ‘stopping’ in the FTP logs will help us to find the log about when the service was stopped.</p><figure class="graf graf--figure graf-after--p" id="1c26" name="1c26"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="753" data-image-id="1*V7ZeyrSaXZdtQJhlat4hfw.png" data-width="1818" src="https://cdn-images-1.medium.com/max/800/1*V7ZeyrSaXZdtQJhlat4hfw.png"/></figure><p class="graf graf--p graf-after--figure" id="aa92" name="aa92"><strong class="markup--strong markup--p-strong">Answer: </strong>Aug 02 14:00:15</p><figure class="graf graf--figure graf-after--p" id="5c12" name="5c12"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="217" data-image-id="1*Q7pgyw3m1R02RtHtDQFANg.png" data-width="1425" src="https://cdn-images-1.medium.com/max/800/1*Q7pgyw3m1R02RtHtDQFANg.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="43ca" name="43ca"><strong class="markup--strong markup--blockquote-strong">What is the full path of the file related to the FTP service that was modified before the FTP service was restarted on the system that allowed anonymous logins between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="ed19" name="ed19">Examining the relevant host’s audit logs allows us to observe the activity. The answer can be found in the full log content and the fielded state.</p><figure class="graf graf--figure graf-after--p" id="3882" name="3882"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="785" data-image-id="1*2Xm0SzPg5P0_CT4W6NQPoQ.png" data-width="1830" src="https://cdn-images-1.medium.com/max/800/1*2Xm0SzPg5P0_CT4W6NQPoQ.png"/></figure><p class="graf graf--p graf-after--figure" id="f676" name="f676">type=SYSCALL msg=audit(1722777448.253:733): arch=c000003e syscall=59 success=yes exit=0 a0=56432e7a6700 a1=56432e754480 a2=56432e6ec6f0 a3=8 items=2 ppid=8289 pid=38868 auid=0 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=9 comm=”vim” exe=”/usr/bin/vim” key=”susp_activity”ARCH=x86_64 SYSCALL=execve AUID=”root” UID=”root” GID=”root” EUID=”root” SUID=”root” FSUID=”root” EGID=”root” SGID=”root” FSGID=”root” type=EXECVE msg=audit(1722777448.253:733): argc=7 a0=”vim” a1=”/etc/proftpd/proftpd.conf” type=PATH msg=audit(1722777448.253:733): item=0 name=”/usr/bin/vim” inode=134362700 dev=fd:00 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0OUID=”root” OGID=”root” type=PATH msg=audit(1722777448.253:733): item=1 name=”/lib64/ld-linux-x86–64.so.2" inode=201327911 dev=fd:00 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0OUID=”root” OGID=”root” type=PROCTITLE msg=audit(1722777448.253:733): proctitle=6E6D6170002D7353002D506E002D6E002D700032320031302E31302E31302E302F3234</p><p class="graf graf--p graf-after--p" id="171c" name="171c"><strong class="markup--strong markup--p-strong">Answer: </strong>/etc/proftpd/proftpd.conf</p><figure class="graf graf--figure graf-after--p" id="fc1b" name="fc1b"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="163" data-image-id="1*VpptpMS6F773-ZDFkTVidQ.png" data-width="1467" src="https://cdn-images-1.medium.com/max/800/1*VpptpMS6F773-ZDFkTVidQ.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="9c66" name="9c66"><strong class="markup--strong markup--blockquote-strong">Which user modified the file related to the FTP service before it was restarted on the system that allowed anonymous logins between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="adc7" name="adc7">If we look at the full log content, we can determine that it is the root user.</p><p class="graf graf--p graf-after--p" id="cc6c" name="cc6c"><strong class="markup--strong markup--p-strong">Answer: </strong>root</p><figure class="graf graf--figure graf-after--p" id="dc2f" name="dc2f"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="160" data-image-id="1*koOb08H3gKtgMxpSTzGc_Q.png" data-width="1440" src="https://cdn-images-1.medium.com/max/800/1*koOb08H3gKtgMxpSTzGc_Q.png"/></figure><blockquote class="graf graf--blockquote graf-after--figure" id="8312" name="8312"><strong class="markup--strong markup--blockquote-strong">From which IP address did the user who modified the FTP service file log in via SSH before the FTP service was restarted on the system that allowed anonymous logins between Aug 1, 2024 00:00 — Aug 7, 2024 00:00?</strong></blockquote><p class="graf graf--p graf-after--blockquote" id="9448" name="9448">If we look at the sshd logs, we can detect the ssh connecting IP.</p><figure class="graf graf--figure graf-after--p" id="0846" name="0846"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="755" data-image-id="1*dz0fEg3Nx24YDQ1jKMOS2Q.png" data-width="1835" src="https://cdn-images-1.medium.com/max/800/1*dz0fEg3Nx24YDQ1jKMOS2Q.png"/></figure><p class="graf graf--p graf-after--figure" id="35f6" name="35f6"><strong class="markup--strong markup--p-strong">Answer: </strong>10.34.1.13</p><figure class="graf graf--figure graf-after--p graf--trailing" id="4757" name="4757"><img class="graf-image w-full rounded-lg shadow-lg my-8" data-height="166" data-image-id="1*D_l3FtCKk5d6rwQ99nWhSQ.png" data-width="1489" src="https://cdn-images-1.medium.com/max/800/1*D_l3FtCKk5d6rwQ99nWhSQ.png"/></figure></div></div></section>
</div>
        </article>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 pt-16 pb-8 border-t border-slate-800">
        <div class="max-w-4xl mx-auto px-6 text-center">
            <div class="flex justify-center gap-8 mb-8">
                <a href="https://github.com/yusufarbc" target="_blank"
                    class="text-slate-400 hover:text-white transition-colors text-2xl"><i class="fab fa-github"></i></a>
                <a href="https://linkedin.com/in/yusufarbc" target="_blank"
                    class="text-slate-400 hover:text-[#0077b5] transition-colors text-2xl"><i
                        class="fab fa-linkedin"></i></a>
                <a href="https://x.com/yusufarbc" target="_blank"
                    class="text-slate-400 hover:text-white transition-colors text-2xl"><i
                        class="fab fa-x-twitter"></i></a>
            </div>
            <p class="text-slate-600 text-sm font-mono">© 2025 Yusuf Talha ARABACI</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

</body>

</html>




